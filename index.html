<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Sistem Gudang</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">

  <h1 class="text-2xl font-bold mb-4">ðŸ“¦ Sistem Manajemen Gudang</h1>

  <!-- Pilih Store -->
  <div>
    <label>Store:</label>
    <select id="storeSelect" class="border p-2"></select>
  </div>

  <!-- Input Barang -->
  <div class="mt-4">
    <label>Kode Barang:</label>
    <input id="kodeBarang" class="border p-2" type="text">
    <label>Nama Barang:</label>
    <input id="namaBarang" class="border p-2" type="text">
    <label>Kuantitas:</label>
    <input id="qty" class="border p-2" type="number">
    <label>Unit:</label>
    <input id="unit" class="border p-2" type="text">
  </div>

  <!-- Tombol -->
  <div class="mt-4 space-x-2">
    <button onclick="tambahPenerimaan()" class="bg-green-500 text-white px-4 py-2">+ Penerimaan</button>
    <button onclick="tambahPengeluaran()" class="bg-red-500 text-white px-4 py-2">- Pengeluaran</button>
  </div>

  <!-- Data Barang -->
  <h2 class="text-xl font-semibold mt-6">ðŸ“‹ Database Barang</h2>
  <table class="table-auto border mt-2 w-full" id="barangTable"></table>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbwXeL_SU-1WT3-6awEXbVkE9N3b_E-ygq2SVbc3uHFDpvW-KfWL3HAjoYaTMlM4kRW3kQ/exec";

    async function loadStores() {
      const res = await fetch(`${API_URL}?action=getStores`);
      const data = await res.json();
      const select = document.getElementById("storeSelect");
      select.innerHTML = data.map(s => `<option value="${s.kode}">${s.nama}</option>`).join("");
    }

    async function loadBarang() {
      const res = await fetch(`${API_URL}?action=getBarang`);
      const data = await res.json();
      const table = document.getElementById("barangTable");
      table.innerHTML = "<tr><th>Kode</th><th>Nama</th><th>Qty</th><th>Unit</th></tr>" +
        data.map(b => `<tr><td>${b.kode}</td><td>${b.nama}</td><td>${b.qty}</td><td>${b.unit}</td></tr>`).join("");
    }

    async function tambahPenerimaan() {
      const body = {
        action: "tambahPenerimaan",
        kode: document.getElementById("kodeBarang").value,
        nama: document.getElementById("namaBarang").value,
        qty: document.getElementById("qty").value,
        unit: document.getElementById("unit").value
      };
      await fetch(API_URL, { method: "POST", body: JSON.stringify(body) });
      alert("Penerimaan berhasil ditambahkan!");
      loadBarang();
    }

    async function tambahPengeluaran() {
      const body = {
        action: "tambahPengeluaran",
        kode: document.getElementById("kodeBarang").value,
        nama: document.getElementById("namaBarang").value,
        qty: document.getElementById("qty").value,
        unit: document.getElementById("unit").value
      };
      await fetch(API_URL, { method: "POST", body: JSON.stringify(body) });
      alert("Pengeluaran berhasil ditambahkan!");
      loadBarang();
    }

    loadStores();
    loadBarang();
  </script>
</body>
</html>