<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModernStock - Sistem Manajemen Gudang</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#64748b'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Mobile Menu Overlay -->
    <div id="mobileOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden lg:hidden"></div>
    
    <div class="flex h-screen">
        <!-- Sidebar -->
        <div id="sidebar" class="fixed lg:relative w-64 bg-white shadow-lg border-r transition-all duration-300 ease-in-out z-50 h-full -translate-x-full lg:translate-x-0">
            <!-- Logo -->
            <div class="p-4 lg:p-6 border-b">
                <div class="flex items-center justify-between">
                    <div id="logoText">
                        <h1 class="text-lg lg:text-2xl font-bold text-primary">ðŸ“¦ INVENTORY MANAGEMENT</h1>
                        <p class="text-xs lg:text-sm text-gray-500 mt-1">Sistem Manajemen Gudang</p>
                    </div>
                    <button onclick="toggleSidebar()" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                        <svg id="sidebarToggleIcon" class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="mt-4 lg:mt-6">
                <div class="px-3 lg:px-4 space-y-2">
                    <a href="#" onclick="showSection('dashboard')" class="nav-item active flex items-center px-4 py-3 text-sm font-medium rounded-lg bg-primary text-white">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                        </svg>
                        <span class="nav-text">Dashboard</span>
                    </a>
                    
                    <a href="#" onclick="showSection('incoming')" class="nav-item flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                        </svg>
                        <span class="nav-text">Incoming</span>
                        <span class="nav-text ml-auto bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">3</span>
                    </a>



                    <a href="#" onclick="showSection('status')" class="nav-item flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <span class="nav-text">Status</span>
                        <span class="nav-text ml-auto bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full">2</span>
                    </a>

                    <a href="#" onclick="showSection('store')" class="nav-item flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                        </svg>
                        <span class="nav-text">Kartu Store</span>
                    </a>

                    <a href="#" onclick="showSection('history')" class="nav-item flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <span class="nav-text">Riwayat</span>
                    </a>

                    <a href="#" onclick="showSection('recap')" class="nav-item flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <span class="nav-text">Rekapitulasi</span>
                    </a>

                    <a href="#" onclick="showSection('export')" class="nav-item flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <span class="nav-text">Export Data</span>
                    </a>

                    <a href="#" onclick="showSection('settings')" class="nav-item flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                        <span class="nav-text">Settings</span>
                    </a>
                </div>
            </nav>

            <!-- User Profile -->
            <div class="absolute bottom-0 w-64 p-3 lg:p-4 border-t">
                <div class="flex items-center">
                    <div class="w-8 h-8 lg:w-10 lg:h-10 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
                        <span class="text-white font-medium text-sm lg:text-base">A</span>
                    </div>
                    <div class="ml-3 nav-text">
                        <p class="text-xs lg:text-sm font-medium text-gray-900">Admin</p>
                        <p class="text-xs text-gray-500">admin@inventory.com</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden lg:ml-0">
            <!-- Header -->
            <header class="bg-white shadow-sm border-b px-4 lg:px-6 py-3 lg:py-4">
                <div class="flex justify-between items-center">
                    <div class="flex items-center">
                        <!-- Mobile Menu Button -->
                        <button onclick="toggleMobileSidebar()" class="lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors mr-3">
                            <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        </button>
                        <h2 id="pageTitle" class="text-lg lg:text-2xl font-semibold text-gray-900">Dashboard</h2>
                    </div>
                    <div class="flex items-center space-x-2 lg:space-x-4">
                        <button onclick="openAddModal()" class="bg-primary text-white px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium hover:bg-blue-700 transition-colors">
                            <span class="hidden sm:inline">+ Tambah Data</span>
                            <span class="sm:hidden">+</span>
                        </button>
                        <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center">
                            <span class="text-sm font-medium">A</span>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <main class="flex-1 overflow-y-auto p-4 lg:p-6">
                <!-- Dashboard Section -->
                <div id="dashboard" class="section">
                    <!-- Stats Cards -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-6 lg:mb-8">
                        <div class="bg-white rounded-xl shadow-sm p-4 lg:p-6 border">
                            <div class="flex items-center">
                                <div class="p-2 bg-blue-100 rounded-lg">
                                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                                    </svg>
                                </div>
                                <div class="ml-4">
                                    <p class="text-sm font-medium text-gray-600">Total Barang</p>
                                    <p class="text-2xl font-semibold text-gray-900">2,847</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-xl shadow-sm p-4 lg:p-6 border">
                            <div class="flex items-center">
                                <div class="p-2 bg-green-100 rounded-lg">
                                    <svg class="w-5 h-5 lg:w-6 lg:h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div class="ml-3 lg:ml-4">
                                    <p class="text-xs lg:text-sm font-medium text-gray-600">Incoming Pending</p>
                                    <p class="text-xl lg:text-2xl font-semibold text-gray-900">3</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-xl shadow-sm p-4 lg:p-6 border">
                            <div class="flex items-center">
                                <div class="p-2 bg-yellow-100 rounded-lg">
                                    <svg class="w-5 h-5 lg:w-6 lg:h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                                    </svg>
                                </div>
                                <div class="ml-3 lg:ml-4">
                                    <p class="text-xs lg:text-sm font-medium text-gray-600">Status Pending</p>
                                    <p class="text-xl lg:text-2xl font-semibold text-gray-900">2</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white rounded-xl shadow-sm p-4 lg:p-6 border">
                            <div class="flex items-center">
                                <div class="p-2 bg-purple-100 rounded-lg">
                                    <svg class="w-5 h-5 lg:w-6 lg:h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                    </svg>
                                </div>
                                <div class="ml-3 lg:ml-4">
                                    <p class="text-xs lg:text-sm font-medium text-gray-600">Nilai Inventori</p>
                                    <p class="text-xl lg:text-2xl font-semibold text-gray-900">Rp 2.4M</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-white rounded-xl shadow-sm border p-4 lg:p-6">
                        <h3 class="text-base lg:text-lg font-semibold text-gray-900 mb-4">Aktivitas Terbaru</h3>
                        <div class="space-y-4" id="recentActivity">
                            <div class="flex items-start space-x-3">
                                <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                                <div>
                                    <p class="text-sm text-gray-900">Incoming selesai: 50 unit Laptop Dell masuk ke Store 1</p>
                                    <p class="text-xs text-gray-500">2 jam yang lalu</p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-3">
                                <div class="w-2 h-2 bg-yellow-500 rounded-full mt-2"></div>
                                <div>
                                    <p class="text-sm text-gray-900">Status pending: Mouse Wireless menunggu verifikasi</p>
                                    <p class="text-xs text-gray-500">4 jam yang lalu</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Incoming Section -->
                <div id="incoming" class="section hidden">
                    <div class="bg-white rounded-xl shadow-sm border">
                        <div class="px-4 lg:px-6 py-3 lg:py-4 border-b border-gray-200">
                            <h3 class="text-base lg:text-lg font-semibold text-gray-900">Data Incoming</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase">Kode</th>
                                        <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase">Nama Barang</th>
                                        <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase hidden sm:table-cell">Jumlah</th>
                                        <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase hidden md:table-cell">Tanggal</th>
                                        <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                        <th class="px-3 lg:px-6 py-2 lg:py-3 text-left text-xs font-medium text-gray-500 uppercase">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="incomingTable">
                                    <tr>
                                        <td class="px-3 lg:px-6 py-3 lg:py-4 whitespace-nowrap text-xs lg:text-sm font-medium text-gray-900">IN001</td>
                                        <td class="px-3 lg:px-6 py-3 lg:py-4 whitespace-nowrap text-xs lg:text-sm text-gray-900">
                                            <div>Laptop Dell XPS 13</div>
                                            <div class="text-xs text-gray-500 sm:hidden">Qty: 25 | 2024-01-15</div>
                                        </td>
                                        <td class="px-3 lg:px-6 py-3 lg:py-4 whitespace-nowrap text-xs lg:text-sm text-gray-900 hidden sm:table-cell">25</td>
                                        <td class="px-3 lg:px-6 py-3 lg:py-4 whitespace-nowrap text-xs lg:text-sm text-gray-500 hidden md:table-cell">2024-01-15</td>
                                        <td class="px-3 lg:px-6 py-3 lg:py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Pending</span>
                                        </td>
                                        <td class="px-3 lg:px-6 py-3 lg:py-4 whitespace-nowrap text-xs lg:text-sm font-medium">
                                            <div class="flex flex-col sm:flex-row gap-1 sm:gap-3">
                                                <button onclick="updateStatus('IN001', 'selesai')" class="text-green-600 hover:text-green-700">Selesai</button>
                                                <button class="text-red-600 hover:text-red-700">Hapus</button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>



                <!-- Status Section -->
                <div id="status" class="section hidden">
                    <div class="bg-white rounded-xl shadow-sm border">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-900">Status Pending</h3>
                            <p class="text-sm text-gray-500 mt-1">Barang yang menunggu verifikasi dari incoming</p>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Kode</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nama Barang</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Jumlah</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Tanggal Masuk</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status Verifikasi</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Catatan</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="statusTable">
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">IN002</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Keyboard Mechanical</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">15</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-13</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Menunggu Verifikasi</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Menunggu konfirmasi kualitas</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="moveToStore('IN002')" class="text-gray-400 cursor-not-allowed mr-3" disabled title="Menunggu verifikasi dari incoming">Pindah ke Store</button>
                                            <button onclick="addNoteToStatus('IN002')" class="text-blue-600 hover:text-blue-700">Edit Catatan</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Store Section -->
                <div id="store" class="section hidden">
                    <!-- Store Selection -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Pilih Store:</label>
                        <select id="storeSelector" onchange="filterByStore()" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                            <option value="">Semua Store</option>
                            <option value="01">01 - GENERAL STORE (ANYER)</option>
                            <option value="02">02 - General store (JKT)</option>
                            <option value="03">03 - MAIN KITCHEN STORAGE</option>
                            <option value="04">04 - F&B ADMIN</option>
                            <option value="05">05 - HOUSEKEEPING</option>
                            <option value="10">10 - ENGINEERING STORE</option>
                            <option value="11">11 - PROJECT STORE</option>
                            <option value="12">12 - ADMIN & GENERAL</option>
                            <option value="13">13 - SALES & MARKETING</option>
                            <option value="14">14 - SECURITY</option>
                            <option value="15">15 - FRONT OFFICE</option>
                            <option value="16">16 - SPA</option>
                            <option value="17">17 - HRD</option>
                            <option value="21">21 - D'BISTRO</option>
                            <option value="22">22 - KOREAN STORE (KANTIN)</option>
                            <option value="23">23 - DBAR STORE</option>
                            <option value="24">24 - LIQUOR STORE</option>
                            <option value="25">25 - SOUVENIR SHOP</option>
                            <option value="26">26 - SPORT & RECREATION</option>
                            <option value="27">27 - JAPANESE STORE</option>
                            <option value="28">28 - DRAGON BEACH CLUB STORE</option>
                            <option value="29">29 - SUNSET GRILL STORE</option>
                            <option value="31">31 - BANQUET STORE</option>
                            <option value="40">40 - LAUNDRY STORE</option>
                        </select>
                    </div>

                    <div class="bg-white rounded-xl shadow-sm border">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-900">Kartu Store</h3>
                            <p class="text-sm text-gray-500 mt-1">Barang yang sudah masuk ke gudang penyimpanan</p>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Kode Store</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nama Store</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nama Barang</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Qty</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Tanggal Incoming</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="storeTable">
                                    <tr data-store="01">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">01</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">GENERAL STORE (ANYER)</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Laptop Dell XPS 13</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">50</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-10</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Tersedia</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="transferItem(this)" class="text-blue-600 hover:text-blue-700">Transfer</button>
                                        </td>
                                    </tr>
                                    <tr data-store="03">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">03</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAIN KITCHEN STORAGE</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Blender Industrial</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">5</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-12</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Tersedia</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="transferItem(this)" class="text-blue-600 hover:text-blue-700">Transfer</button>
                                        </td>
                                    </tr>
                                    <tr data-store="21">
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">21</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">D'BISTRO</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Coffee Machine</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-08</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Tersedia</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="transferItem(this)" class="text-blue-600 hover:text-blue-700">Transfer</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- History Section -->
                <div id="history" class="section hidden">
                    <div class="bg-white rounded-xl shadow-sm border">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-900">Riwayat Transaksi</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ID Transaksi</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Jenis</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nama Barang</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Jumlah</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Tanggal</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">User</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="historyTable">
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">TRX001</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Incoming</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Laptop Dell XPS 13</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">50</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-10 14:30</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Admin</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Recap Section -->
                <div id="recap" class="section hidden">
                    <div class="bg-white rounded-xl shadow-sm border">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-900">Rekapitulasi Inventori</h3>
                            <p class="text-sm text-gray-500 mt-1">Daftar lengkap semua barang dalam sistem</p>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Kode Barang</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nama Barang</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Qty</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Unit</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Min Stock</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status Stock</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="recapTable">
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">BRG001</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Laptop Dell XPS 13</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">50</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Unit</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">10</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aman</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="editItem('BRG001')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                            <button onclick="deleteItem('BRG001')" class="text-red-600 hover:text-red-700">Hapus</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">BRG002</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Keyboard Mechanical</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">15</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Unit</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">20</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">Kurang</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="editItem('BRG002')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                            <button onclick="deleteItem('BRG002')" class="text-red-600 hover:text-red-700">Hapus</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">BRG003</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Blender Industrial</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">5</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Unit</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">3</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aman</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="editItem('BRG003')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                            <button onclick="deleteItem('BRG003')" class="text-red-600 hover:text-red-700">Hapus</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">BRG004</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Coffee Machine</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Unit</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Minimal</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="editItem('BRG004')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                            <button onclick="deleteItem('BRG004')" class="text-red-600 hover:text-red-700">Hapus</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">BRG005</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Mouse Wireless</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">35</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Unit</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">15</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aman</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                            <button onclick="editItem('BRG005')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                            <button onclick="deleteItem('BRG005')" class="text-red-600 hover:text-red-700">Hapus</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Export Section -->
                <div id="export" class="section hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Export Rekapitulasi -->
                        <div class="bg-white rounded-xl shadow-sm border">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <div class="flex items-center">
                                    <div class="p-2 bg-green-100 rounded-lg mr-4">
                                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-gray-900">Export Rekapitulasi</h3>
                                        <p class="text-sm text-gray-500 mt-1">Download laporan lengkap inventori</p>
                                    </div>
                                </div>
                            </div>
                            <div class="px-6 py-6">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Format File:</label>
                                        <div class="space-y-2">
                                            <label class="flex items-center">
                                                <input type="radio" name="recapFormat" value="excel" class="text-primary focus:ring-primary" checked>
                                                <span class="ml-2 text-sm text-gray-700">Excel (.xlsx)</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="recapFormat" value="pdf" class="text-primary focus:ring-primary">
                                                <span class="ml-2 text-sm text-gray-700">PDF (.pdf)</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Filter Status Stock:</label>
                                        <select id="recapStatusFilter" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                            <option value="all">Semua Status</option>
                                            <option value="aman">Aman</option>
                                            <option value="minimal">Minimal</option>
                                            <option value="kurang">Kurang</option>
                                        </select>
                                    </div>
                                    <div class="pt-4">
                                        <button onclick="exportRecap()" class="w-full bg-green-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center">
                                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                            </svg>
                                            Download Rekapitulasi
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Export Kartu Store -->
                        <div class="bg-white rounded-xl shadow-sm border">
                            <div class="px-6 py-4 border-b border-gray-200">
                                <div class="flex items-center">
                                    <div class="p-2 bg-blue-100 rounded-lg mr-4">
                                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-gray-900">Export Kartu Store</h3>
                                        <p class="text-sm text-gray-500 mt-1">Download data per store/gudang</p>
                                    </div>
                                </div>
                            </div>
                            <div class="px-6 py-6">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Pilih Store:</label>
                                        <select id="exportStoreSelector" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                            <option value="all">Semua Store</option>
                                            <option value="01">01 - GENERAL STORE (ANYER)</option>
                                            <option value="02">02 - General store (JKT)</option>
                                            <option value="03">03 - MAIN KITCHEN STORAGE</option>
                                            <option value="04">04 - F&B ADMIN</option>
                                            <option value="05">05 - HOUSEKEEPING</option>
                                            <option value="10">10 - ENGINEERING STORE</option>
                                            <option value="11">11 - PROJECT STORE</option>
                                            <option value="12">12 - ADMIN & GENERAL</option>
                                            <option value="13">13 - SALES & MARKETING</option>
                                            <option value="14">14 - SECURITY</option>
                                            <option value="15">15 - FRONT OFFICE</option>
                                            <option value="16">16 - SPA</option>
                                            <option value="17">17 - HRD</option>
                                            <option value="21">21 - D'BISTRO</option>
                                            <option value="22">22 - KOREAN STORE (KANTIN)</option>
                                            <option value="23">23 - DBAR STORE</option>
                                            <option value="24">24 - LIQUOR STORE</option>
                                            <option value="25">25 - SOUVENIR SHOP</option>
                                            <option value="26">26 - SPORT & RECREATION</option>
                                            <option value="27">27 - JAPANESE STORE</option>
                                            <option value="28">28 - DRAGON BEACH CLUB STORE</option>
                                            <option value="29">29 - SUNSET GRILL STORE</option>
                                            <option value="31">31 - BANQUET STORE</option>
                                            <option value="40">40 - LAUNDRY STORE</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Format File:</label>
                                        <div class="space-y-2">
                                            <label class="flex items-center">
                                                <input type="radio" name="storeFormat" value="excel" class="text-primary focus:ring-primary" checked>
                                                <span class="ml-2 text-sm text-gray-700">Excel (.xlsx)</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="storeFormat" value="pdf" class="text-primary focus:ring-primary">
                                                <span class="ml-2 text-sm text-gray-700">PDF (.pdf)</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="pt-4">
                                        <button onclick="exportStore()" class="w-full bg-blue-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center">
                                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                            </svg>
                                            Download Kartu Store
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Export History -->
                    <div class="mt-6 bg-white rounded-xl shadow-sm border">
                        <div class="px-6 py-4 border-b border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-900">Riwayat Export</h3>
                            <p class="text-sm text-gray-500 mt-1">File yang telah didownload</p>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nama File</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Jenis Export</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Format</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Tanggal</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="exportHistoryTable">
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Rekapitulasi_2024-01-15.xlsx</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Rekapitulasi</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Excel</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-15 10:30</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Berhasil</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Store_01_2024-01-14.pdf</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Kartu Store</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">PDF</td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">2024-01-14 15:45</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Berhasil</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div id="settings" class="section hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Store Management -->
                        <div class="bg-white rounded-xl shadow-sm border">
                            <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-900">Manajemen Store</h3>
                                    <p class="text-sm text-gray-500 mt-1">Kelola daftar store/gudang</p>
                                </div>
                                <button onclick="openStoreModal()" class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors">
                                    + Tambah Store
                                </button>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Kode</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nama Store</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200" id="storeSettingsTable">
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">01</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">GENERAL STORE (ANYER)</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editStore('01')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteStore('01')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">02</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">General store (JKT)</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editStore('02')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteStore('02')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">03</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">MAIN KITCHEN STORAGE</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editStore('03')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteStore('03')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">04</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">F&B ADMIN</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editStore('04')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteStore('04')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">05</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">HOUSEKEEPING</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editStore('05')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteStore('05')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Unit Management -->
                        <div class="bg-white rounded-xl shadow-sm border">
                            <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-900">Manajemen Unit</h3>
                                    <p class="text-sm text-gray-500 mt-1">Kelola satuan unit barang</p>
                                </div>
                                <button onclick="openUnitModal()" class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors">
                                    + Tambah Unit
                                </button>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nama Unit</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Deskripsi</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200" id="unitSettingsTable">
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Unit</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Satuan unit/buah</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editUnit('Unit')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteUnit('Unit')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Pcs</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Pieces/potong</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editUnit('Pcs')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteUnit('Pcs')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Kg</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Kilogram</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editUnit('Kg')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteUnit('Kg')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Liter</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Liter</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editUnit('Liter')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteUnit('Liter')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Box</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Kotak/dus</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editUnit('Box')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteUnit('Box')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">Pack</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Kemasan/paket</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="editUnit('Pack')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                                                <button onclick="deleteUnit('Pack')" class="text-red-600 hover:text-red-700">Hapus</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Transfer Modal -->
    <div id="transferModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Transfer Barang</h3>
            </div>
            <div class="px-6 py-4">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nama Barang</label>
                        <input type="text" id="transferItemName" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Qty Transfer</label>
                        <input type="number" id="transferQty" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="0">
                        <p class="text-xs text-gray-500 mt-1">Stok tersedia: <span id="availableStock">0</span></p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Store Tujuan</label>
                        <select id="transferDestination" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                            <option value="">Pilih Store Tujuan</option>
                            <option value="01">01 - GENERAL STORE (ANYER)</option>
                            <option value="02">02 - General store (JKT)</option>
                            <option value="03">03 - MAIN KITCHEN STORAGE</option>
                            <option value="04">04 - F&B ADMIN</option>
                            <option value="05">05 - HOUSEKEEPING</option>
                            <option value="10">10 - ENGINEERING STORE</option>
                            <option value="11">11 - PROJECT STORE</option>
                            <option value="12">12 - ADMIN & GENERAL</option>
                            <option value="13">13 - SALES & MARKETING</option>
                            <option value="14">14 - SECURITY</option>
                            <option value="15">15 - FRONT OFFICE</option>
                            <option value="16">16 - SPA</option>
                            <option value="17">17 - HRD</option>
                            <option value="21">21 - D'BISTRO</option>
                            <option value="22">22 - KOREAN STORE (KANTIN)</option>
                            <option value="23">23 - DBAR STORE</option>
                            <option value="24">24 - LIQUOR STORE</option>
                            <option value="25">25 - SOUVENIR SHOP</option>
                            <option value="26">26 - SPORT & RECREATION</option>
                            <option value="27">27 - JAPANESE STORE</option>
                            <option value="28">28 - DRAGON BEACH CLUB STORE</option>
                            <option value="29">29 - SUNSET GRILL STORE</option>
                            <option value="31">31 - BANQUET STORE</option>
                            <option value="40">40 - LAUNDRY STORE</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-3">
                <button onclick="closeTransferModal()" class="px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">Batal</button>
                <button onclick="executeTransfer()" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors">Transfer</button>
            </div>
        </div>
    </div>

    <!-- Add Modal -->
    <div id="addModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900" id="modalTitle">Tambah Data Incoming</h3>
            </div>
            <div class="px-6 py-4">
                <form id="addForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Kode</label>
                        <input type="text" id="itemCode" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="IN001" oninput="checkExistingItem()">
                        <p class="text-xs text-gray-500 mt-1" id="itemCodeHint">Masukkan kode barang (otomatis terisi jika sudah ada di rekap)</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nama Barang</label>
                        <input type="text" id="itemName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Masukkan nama barang">
                        <p class="text-xs text-green-600 mt-1 hidden" id="itemFoundMessage">âœ“ Barang ditemukan di rekap - nama dan unit terisi otomatis</p>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Jumlah</label>
                        <input type="number" id="itemQuantity" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="0">
                    </div>
                    <div id="destinationField" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Tujuan</label>
                        <input type="text" id="itemDestination" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Cabang Jakarta">
                    </div>
                    <div id="storeField" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Pilih Store Tujuan</label>
                        <select id="itemStore" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                            <option value="">Pilih Store</option>
                            <option value="01">01 - GENERAL STORE (ANYER)</option>
                            <option value="02">02 - General store (JKT)</option>
                            <option value="03">03 - MAIN KITCHEN STORAGE</option>
                            <option value="04">04 - F&B ADMIN</option>
                            <option value="05">05 - HOUSEKEEPING</option>
                            <option value="10">10 - ENGINEERING STORE</option>
                            <option value="11">11 - PROJECT STORE</option>
                            <option value="12">12 - ADMIN & GENERAL</option>
                            <option value="13">13 - SALES & MARKETING</option>
                            <option value="14">14 - SECURITY</option>
                            <option value="15">15 - FRONT OFFICE</option>
                            <option value="16">16 - SPA</option>
                            <option value="17">17 - HRD</option>
                            <option value="21">21 - D'BISTRO</option>
                            <option value="22">22 - KOREAN STORE (KANTIN)</option>
                            <option value="23">23 - DBAR STORE</option>
                            <option value="24">24 - LIQUOR STORE</option>
                            <option value="25">25 - SOUVENIR SHOP</option>
                            <option value="26">26 - SPORT & RECREATION</option>
                            <option value="27">27 - JAPANESE STORE</option>
                            <option value="28">28 - DRAGON BEACH CLUB STORE</option>
                            <option value="29">29 - SUNSET GRILL STORE</option>
                            <option value="31">31 - BANQUET STORE</option>
                            <option value="40">40 - LAUNDRY STORE</option>
                        </select>
                    </div>
                    <div id="unitField">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Unit</label>
                        <select id="itemUnit" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                            <option value="Unit">Unit</option>
                            <option value="Pcs">Pcs</option>
                            <option value="Kg">Kg</option>
                            <option value="Liter">Liter</option>
                            <option value="Box">Box</option>
                            <option value="Pack">Pack</option>
                        </select>
                    </div>
                    <div id="minStockField" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Min Stock</label>
                        <input type="number" id="itemMinStock" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="0">
                    </div>
                </form>
            </div>
            <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-3">
                <button onclick="closeModal()" class="px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">Batal</button>
                <button onclick="addData()" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors" id="submitButton">Tambah Data</button>
            </div>
        </div>
    </div>

    <!-- Notes Modal -->
    <div id="notesModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Edit Catatan</h3>
            </div>
            <div class="px-6 py-4">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Kode Barang</label>
                        <input type="text" id="noteItemCode" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nama Barang</label>
                        <input type="text" id="noteItemName" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Catatan</label>
                        <textarea id="noteText" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Masukkan catatan untuk barang ini..."></textarea>
                    </div>
                </div>
            </div>
            <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-3">
                <button onclick="closeNotesModal()" class="px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">Batal</button>
                <button onclick="saveNote()" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Edit Item Modal -->
    <div id="editModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900">Edit Barang</h3>
            </div>
            <div class="px-6 py-4">
                <form id="editForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Kode Barang</label>
                        <input type="text" id="editItemCode" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nama Barang</label>
                        <input type="text" id="editItemName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Qty</label>
                        <input type="number" id="editItemQuantity" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Unit</label>
                        <select id="editItemUnit" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                            <option value="Unit">Unit</option>
                            <option value="Pcs">Pcs</option>
                            <option value="Kg">Kg</option>
                            <option value="Liter">Liter</option>
                            <option value="Box">Box</option>
                            <option value="Pack">Pack</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Min Stock</label>
                        <input type="number" id="editItemMinStock" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                    </div>
                </form>
            </div>
            <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-3">
                <button onclick="closeEditModal()" class="px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">Batal</button>
                <button onclick="saveEditItem()" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Store Modal -->
    <div id="storeModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900" id="storeModalTitle">Tambah Store</h3>
            </div>
            <div class="px-6 py-4">
                <form id="storeForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Kode Store</label>
                        <input type="text" id="storeCode" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="01">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nama Store</label>
                        <input type="text" id="storeName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="GENERAL STORE (ANYER)">
                    </div>
                </form>
            </div>
            <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-3">
                <button onclick="closeStoreModal()" class="px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">Batal</button>
                <button onclick="saveStore()" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors" id="storeSubmitButton">Simpan</button>
            </div>
        </div>
    </div>

    <!-- Unit Modal -->
    <div id="unitModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full mx-4">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900" id="unitModalTitle">Tambah Unit</h3>
            </div>
            <div class="px-6 py-4">
                <form id="unitForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nama Unit</label>
                        <input type="text" id="unitName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Gram">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Deskripsi</label>
                        <input type="text" id="unitDescription" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Satuan berat dalam gram">
                    </div>
                </form>
            </div>
            <div class="px-6 py-4 border-t border-gray-200 flex justify-end space-x-3">
                <button onclick="closeUnitModal()" class="px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">Batal</button>
                <button onclick="saveUnit()" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-700 transition-colors" id="unitSubmitButton">Simpan</button>
            </div>
        </div>
    </div>

    <script>
        let currentSection = 'dashboard';
        let sidebarCollapsed = false;
        let mobileSidebarOpen = false;
        // Konfigurasi Google Apps Script
        const GOOGLE_SCRIPT_CONFIG = {
            // URL Web App yang sudah di-deploy dari Google Apps Script
            WEB_APP_URL: 'https://script.google.com/macros/s/AKfycbzRw0anzYzOxfT6pGf2JG6RamhVWe7-RBuXlJVD-yjSBdVrr_h8rYo0ClnVE1xe4ySt/exec',
            
            // Password untuk keamanan (harus sama dengan yang di Google Script)
            API_PASSWORD: 'modernstock2024'
        };

        /**
         * Fungsi untuk mengirim data ke Google Spreadsheet
         */
        async function sendToGoogleSheet(action, payload) {
            try {
                const data = {
                    action: action,
                    password: GOOGLE_SCRIPT_CONFIG.API_PASSWORD,
                    payload: payload,
                    timestamp: new Date().toISOString()
                };
                
                const response = await fetch(GOOGLE_SCRIPT_CONFIG.WEB_APP_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    console.log('âœ… Data berhasil dikirim ke Google Sheet:', result);
                    return result;
                } else {
                    console.error('âŒ Gagal mengirim data:', result.message);
                    throw new Error(result.message);
                }
                
            } catch (error) {
                console.error('âŒ Error mengirim data ke Google Sheet:', error);
                // Jangan throw error agar website tetap berfungsi meski Google Sheet error
                return null;
            }
        }

        /**
         * Helper function untuk menentukan status stock
         */
        function getStatusStock(qty, minStock) {
            if (qty > minStock) return 'Aman';
            if (qty === minStock) return 'Minimal';
            return 'Kurang';
        }

        // Mobile sidebar toggle function
        function toggleMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');
            
            mobileSidebarOpen = !mobileSidebarOpen;
            
            if (mobileSidebarOpen) {
                sidebar.classList.remove('-translate-x-full');
                sidebar.classList.add('translate-x-0');
                overlay.classList.remove('hidden');
            } else {
                sidebar.classList.add('-translate-x-full');
                sidebar.classList.remove('translate-x-0');
                overlay.classList.add('hidden');
            }
        }

        // Close mobile sidebar when clicking overlay
        document.getElementById('mobileOverlay').addEventListener('click', function() {
            toggleMobileSidebar();
        });

        // Desktop sidebar toggle function
        function toggleSidebar() {
            // Check if we're on mobile
            if (window.innerWidth < 1024) {
                toggleMobileSidebar();
                return;
            }
            
            const sidebar = document.getElementById('sidebar');
            const logoText = document.getElementById('logoText');
            const navTexts = document.querySelectorAll('.nav-text');
            const toggleIcon = document.getElementById('sidebarToggleIcon');
            
            sidebarCollapsed = !sidebarCollapsed;
            
            if (sidebarCollapsed) {
                // Collapse sidebar
                sidebar.classList.remove('w-64');
                sidebar.classList.add('w-16');
                logoText.style.display = 'none';
                navTexts.forEach(text => text.style.display = 'none');
                
                // Change icon to expand
                toggleIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>';
            } else {
                // Expand sidebar
                sidebar.classList.remove('w-16');
                sidebar.classList.add('w-64');
                logoText.style.display = 'block';
                navTexts.forEach(text => text.style.display = 'inline');
                
                // Change icon to collapse
                toggleIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>';
            }
        }

        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 1024) {
                // Desktop mode - close mobile sidebar if open
                if (mobileSidebarOpen) {
                    const sidebar = document.getElementById('sidebar');
                    const overlay = document.getElementById('mobileOverlay');
                    sidebar.classList.add('-translate-x-full');
                    sidebar.classList.remove('translate-x-0');
                    overlay.classList.add('hidden');
                    mobileSidebarOpen = false;
                }
            } else {
                // Mobile mode - reset desktop sidebar state
                if (sidebarCollapsed) {
                    const sidebar = document.getElementById('sidebar');
                    const logoText = document.getElementById('logoText');
                    const navTexts = document.querySelectorAll('.nav-text');
                    
                    sidebar.classList.remove('w-16');
                    sidebar.classList.add('w-64');
                    logoText.style.display = 'block';
                    navTexts.forEach(text => text.style.display = 'inline');
                    sidebarCollapsed = false;
                }
            }
        });

        // Navigation functions
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(section).classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active', 'bg-primary', 'text-white');
                item.classList.add('text-gray-700', 'hover:bg-gray-100');
            });
            
            event.target.classList.add('active', 'bg-primary', 'text-white');
            event.target.classList.remove('text-gray-700', 'hover:bg-gray-100');
            
            // Update page title
            const titles = {
                'dashboard': 'Dashboard',
                'incoming': 'Incoming',
                'status': 'Status',
                'store': 'Kartu Store',
                'history': 'Riwayat',
                'recap': 'Rekapitulasi',
                'export': 'Export Data',
                'settings': 'Settings'
            };
            
            document.getElementById('pageTitle').textContent = titles[section];
            currentSection = section;
            
            // Close mobile sidebar after navigation on mobile
            if (window.innerWidth < 1024 && mobileSidebarOpen) {
                toggleMobileSidebar();
            }
        }

        // Store data
        const storeData = {
            '01': 'GENERAL STORE (ANYER)',
            '02': 'General store (JKT)',
            '03': 'MAIN KITCHEN STORAGE',
            '04': 'F&B ADMIN',
            '05': 'HOUSEKEEPING',
            '10': 'ENGINEERING STORE',
            '11': 'PROJECT STORE',
            '12': 'ADMIN & GENERAL',
            '13': 'SALES & MARKETING',
            '14': 'SECURITY',
            '15': 'FRONT OFFICE',
            '16': 'SPA',
            '17': 'HRD',
            '21': 'D\'BISTRO',
            '22': 'KOREAN STORE (KANTIN)',
            '23': 'DBAR STORE',
            '24': 'LIQUOR STORE',
            '25': 'SOUVENIR SHOP',
            '26': 'SPORT & RECREATION',
            '27': 'JAPANESE STORE',
            '28': 'DRAGON BEACH CLUB STORE',
            '29': 'SUNSET GRILL STORE',
            '31': 'BANQUET STORE',
            '40': 'LAUNDRY STORE'
        };

        // Auto-fill function for existing items
        function checkExistingItem() {
            const itemCode = document.getElementById('itemCode').value.trim();
            const itemNameField = document.getElementById('itemName');
            const itemUnitField = document.getElementById('itemUnit');
            const itemMinStockField = document.getElementById('itemMinStock');
            const itemFoundMessage = document.getElementById('itemFoundMessage');
            const itemCodeHint = document.getElementById('itemCodeHint');
            
            if (!itemCode) {
                // Reset fields if code is empty
                itemNameField.value = '';
                itemNameField.readOnly = false;
                itemNameField.classList.remove('bg-gray-100');
                if (itemUnitField) {
                    itemUnitField.disabled = false;
                    itemUnitField.classList.remove('bg-gray-100');
                }
                if (itemMinStockField) {
                    itemMinStockField.value = '';
                    itemMinStockField.readOnly = false;
                    itemMinStockField.classList.remove('bg-gray-100');
                }
                itemFoundMessage.classList.add('hidden');
                itemCodeHint.classList.remove('hidden');
                return;
            }
            
            // Check if item exists in recap table
            const recapRows = document.querySelectorAll('#recapTable tr');
            let foundItem = null;
            
            recapRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === itemCode) {
                    foundItem = {
                        code: row.cells[0].textContent,
                        name: row.cells[1].textContent,
                        unit: row.cells[3].textContent,
                        minStock: row.cells[4].textContent
                    };
                }
            });
            
            if (foundItem) {
                // Item found - auto-fill name, unit, and min stock
                itemNameField.value = foundItem.name;
                itemNameField.readOnly = true;
                itemNameField.classList.add('bg-gray-100');
                
                if (itemUnitField) {
                    itemUnitField.value = foundItem.unit;
                    itemUnitField.disabled = true;
                    itemUnitField.classList.add('bg-gray-100');
                }
                
                if (itemMinStockField) {
                    itemMinStockField.value = foundItem.minStock;
                    itemMinStockField.readOnly = true;
                    itemMinStockField.classList.add('bg-gray-100');
                }
                
                itemFoundMessage.classList.remove('hidden');
                itemCodeHint.classList.add('hidden');
            } else {
                // Item not found - allow manual input
                itemNameField.value = '';
                itemNameField.readOnly = false;
                itemNameField.classList.remove('bg-gray-100');
                
                if (itemUnitField) {
                    itemUnitField.disabled = false;
                    itemUnitField.classList.remove('bg-gray-100');
                }
                
                if (itemMinStockField) {
                    itemMinStockField.value = '';
                    itemMinStockField.readOnly = false;
                    itemMinStockField.classList.remove('bg-gray-100');
                }
                
                itemFoundMessage.classList.add('hidden');
                itemCodeHint.classList.remove('hidden');
            }
        }

        // Modal functions
        function openAddModal() {
            const modal = document.getElementById('addModal');
            const modalTitle = document.getElementById('modalTitle');
            const destinationField = document.getElementById('destinationField');
            const storeField = document.getElementById('storeField');
            const unitField = document.getElementById('unitField');
            const minStockField = document.getElementById('minStockField');
            const submitButton = document.getElementById('submitButton');
            
            if (currentSection === 'status') {
                modalTitle.textContent = 'Pindah ke Store';
                destinationField.classList.add('hidden');
                storeField.classList.remove('hidden');
                unitField.classList.add('hidden');
                minStockField.classList.add('hidden');
                submitButton.textContent = 'Pindah ke Store';
            } else if (currentSection === 'recap') {
                modalTitle.textContent = 'Tambah Barang Baru';
                destinationField.classList.add('hidden');
                storeField.classList.add('hidden');
                unitField.classList.remove('hidden');
                minStockField.classList.remove('hidden');
                submitButton.textContent = 'Tambah Barang';
            } else {
                modalTitle.textContent = 'Tambah Data Incoming';
                destinationField.classList.add('hidden');
                storeField.classList.add('hidden');
                unitField.classList.remove('hidden');
                minStockField.classList.add('hidden');
                submitButton.textContent = 'Tambah Data';
            }
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeModal() {
            document.getElementById('addModal').classList.add('hidden');
            document.getElementById('addModal').classList.remove('flex');
            document.getElementById('addForm').reset();
            
            // Reset auto-fill states
            const itemNameField = document.getElementById('itemName');
            const itemUnitField = document.getElementById('itemUnit');
            const itemMinStockField = document.getElementById('itemMinStock');
            const itemFoundMessage = document.getElementById('itemFoundMessage');
            const itemCodeHint = document.getElementById('itemCodeHint');
            
            itemNameField.readOnly = false;
            itemNameField.classList.remove('bg-gray-100');
            
            if (itemUnitField) {
                itemUnitField.disabled = false;
                itemUnitField.classList.remove('bg-gray-100');
            }
            
            if (itemMinStockField) {
                itemMinStockField.readOnly = false;
                itemMinStockField.classList.remove('bg-gray-100');
            }
            
            itemFoundMessage.classList.add('hidden');
            itemCodeHint.classList.remove('hidden');
        }

        // Edit modal functions
        function editItem(itemCode) {
            const recapRows = document.querySelectorAll('#recapTable tr');
            let itemData = null;
            
            recapRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === itemCode) {
                    itemData = {
                        code: row.cells[0].textContent,
                        name: row.cells[1].textContent,
                        qty: row.cells[2].textContent,
                        unit: row.cells[3].textContent,
                        minStock: row.cells[4].textContent
                    };
                }
            });
            
            if (itemData) {
                document.getElementById('editItemCode').value = itemData.code;
                document.getElementById('editItemName').value = itemData.name;
                document.getElementById('editItemQuantity').value = itemData.qty;
                document.getElementById('editItemUnit').value = itemData.unit;
                document.getElementById('editItemMinStock').value = itemData.minStock;
                
                document.getElementById('editModal').classList.remove('hidden');
                document.getElementById('editModal').classList.add('flex');
            }
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.add('hidden');
            document.getElementById('editModal').classList.remove('flex');
            document.getElementById('editForm').reset();
        }

        function saveEditItem() {
            const code = document.getElementById('editItemCode').value;
            const name = document.getElementById('editItemName').value;
            const qty = parseInt(document.getElementById('editItemQuantity').value);
            const unit = document.getElementById('editItemUnit').value;
            const minStock = parseInt(document.getElementById('editItemMinStock').value);
            
            if (!name || !qty || !unit || minStock === '') {
                alert('Mohon lengkapi semua field!');
                return;
            }
                        
            // Kirim update ke Google Sheet
            const statusStock = getStatusStock(qty, minStock);
            sendToGoogleSheet('update_recap', {
                code: code,
                name: name,
                quantity: qty,
                unit: unit,
                minStock: minStock,
                statusStock: statusStock
            });
            
            // Update the table row
            const recapRows = document.querySelectorAll('#recapTable tr');
            recapRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === code) {
                    row.cells[1].textContent = name;
                    row.cells[2].textContent = qty;
                    row.cells[3].textContent = unit;
                    row.cells[4].textContent = minStock;
                    
                    // Update status stock
                    const statusCell = row.cells[5];
                    if (qty > minStock) {
                        statusCell.innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aman</span>';
                    } else if (qty === minStock) {
                        statusCell.innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Minimal</span>';
                    } else {
                        statusCell.innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">Kurang</span>';
                    }
                }
            });
            
            closeEditModal();
            addActivity(`Barang ${name} berhasil diupdate`, 'blue');
            alert(`Data barang ${name} berhasil diupdate!`);
        }

        function deleteItem(itemCode) {
            if (confirm('Apakah Anda yakin ingin menghapus barang ini?')) {
                const recapRows = document.querySelectorAll('#recapTable tr');
                let itemName = '';
                
                recapRows.forEach(row => {
                    if (row.cells<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97f0f9fdc6a6fe8c',t:'MTc1Nzg2NDM2MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
            // Update the table row
            const recapRows = document.querySelectorAll('#recapTable tr');
            recapRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === code) {
                    row.cells[1].textContent = name;
                    row.cells[2].textContent = qty;
                    row.cells[3].textContent = unit;
                    row.cells[4].textContent = minStock;
                    
                    // Update status stock
                    const statusCell = row.cells[5];
                    if (qty > minStock) {
                        statusCell.innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aman</span>';
                    } else if (qty === minStock) {
                        statusCell.innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Minimal</span>';
                    } else {
                        statusCell.innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">Kurang</span>';
                    }
                }
            });
            
            closeEditModal();
            addActivity(`Barang ${name} berhasil diupdate`, 'blue');
            alert(`Data barang ${name} berhasil diupdate!`);
        }

        function deleteItem(itemCode) {
            if (confirm('Apakah Anda yakin ingin menghapus barang ini?')) {
                const recapRows = document.querySelectorAll('#recapTable tr');
                let itemName = '';
                
                recapRows.forEach(row => {
                    if (row.cells[0] && row.cells[0].textContent === itemCode) {
                        itemName = row.cells[1].textContent;
                        row.remove();
                    }
                });
                
                if (itemName) {
                    addActivity(`Barang ${itemName} berhasil dihapus`, 'red');
                    alert(`Barang ${itemName} berhasil dihapus!`);
                }
            }
        }

        // Add data function
        function addData() {
            const code = document.getElementById('itemCode').value;
            const name = document.getElementById('itemName').value;
            const quantity = document.getElementById('itemQuantity').value;
            const targetStore = document.getElementById('itemStore').value;
            const unit = document.getElementById('itemUnit').value;
            const minStock = document.getElementById('itemMinStock').value;

            if (!code || !name || !quantity) {
                alert('Mohon lengkapi semua field!');
                return;
            }

            if (currentSection === 'incoming' && !unit) {
                alert('Mohon pilih unit untuk barang!');
                return;
            }

            const today = new Date().toISOString().split('T')[0];
            
            if (currentSection === 'incoming') {
                // Check if item exists in recap to update stock or create new incoming
                const recapRows = document.querySelectorAll('#recapTable tr');
                let existingItem = null;
                
                recapRows.forEach(row => {
                    if (row.cells[0] && row.cells[0].textContent === code) {
                        existingItem = row;
                    }
                });
                
                if (existingItem) {
                    // Item exists in recap - this is a stock addition
                    const currentQty = parseInt(existingItem.cells[2].textContent);
                    const newQty = currentQty + parseInt(quantity);
                    existingItem.cells[2].textContent = newQty;
                    
                    // Update status stock based on new quantity
                    const minStock = parseInt(existingItem.cells[4].textContent);
                    const statusCell = existingItem.cells[5];
                    if (newQty > minStock) {
                        statusCell.innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aman</span>';
                    } else if (newQty === minStock) {
                        statusCell.innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Minimal</span>';
                    } else {
                        statusCell.innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">Kurang</span>';
                    }
                    
                    addActivity(`Stock ${name} bertambah ${quantity} unit (total: ${newQty})`, 'green');
                    alert(`Stock ${name} berhasil ditambah ${quantity} unit! Total stock sekarang: ${newQty}`);
                } else {
                    // New item - add to incoming table for processing
                    const table = document.getElementById('incomingTable');
                    const newRow = table.insertRow(0);
                    newRow.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${code}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${name}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${quantity}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${today}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Pending</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="updateStatus('${code}', 'selesai')" class="text-green-600 hover:text-green-700 mr-3">Selesai</button>
                            <button class="text-red-600 hover:text-red-700">Hapus</button>
                        </td>
                    `;
                    
                    // Add to status table
                    addToStatus(code, name, quantity, today);
                    
                    // Add to recap table for new items
                    addToRecap(code, name, quantity, unit, 0);
                }
                
            } else if (currentSection === 'status' && targetStore) {
                // Move selected item from status to store
                const statusRows = document.querySelectorAll('#statusTable tr');
                let selectedItem = null;
                
                statusRows.forEach(row => {
                    if (row.cells[0] && row.cells[0].textContent === code) {
                        selectedItem = {
                            code: code,
                            name: row.cells[1].textContent,
                            quantity: row.cells[2].textContent
                        };
                    }
                });
                
                if (selectedItem) {
                    moveToStore(selectedItem.code, targetStore);
                }
            } else if (currentSection === 'recap') {
                // Add new item to recap table
                if (!unit || minStock === '') {
                    alert('Mohon lengkapi semua field termasuk unit dan min stock!');
                    return;
                }
                
                const table = document.getElementById('recapTable');
                const newRow = table.insertRow(0);
                const qty = parseInt(quantity);
                const minStockNum = parseInt(minStock);
                
                let statusStock = '';
                if (qty > minStockNum) {
                    statusStock = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aman</span>';
                } else if (qty === minStockNum) {
                    statusStock = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Minimal</span>';
                } else {
                    statusStock = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">Kurang</span>';
                }
                
                newRow.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${code}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${quantity}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${unit}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${minStock}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${statusStock}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editItem('${code}')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                        <button onclick="deleteItem('${code}')" class="text-red-600 hover:text-red-700">Hapus</button>
                    </td>
                `;
                
                addActivity(`Barang baru ${name} ditambahkan ke rekapitulasi`, 'green');
            }

            closeModal();
            if (currentSection !== 'status') {
                addToHistory(code, currentSection, name, quantity);
            }
        }

        // Status management functions
        function updateStatus(code, status) {
            if (status === 'selesai') {
                // Update incoming status to verified
                const incomingRows = document.querySelectorAll('#incomingTable tr');
                incomingRows.forEach(row => {
                    if (row.cells[0] && row.cells[0].textContent === code) {
                        row.cells[4].innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Terverifikasi</span>';
                        row.cells[5].innerHTML = '<span class="text-gray-500">Terverifikasi</span>';
                    }
                });
                
                // Update status table to show verified and enable transfer
                updateStatusVerification(code, true);
                
                addActivity(`Barang ${code} telah diverifikasi dan siap dipindah ke store`, 'green');
                alert(`Barang ${code} telah diverifikasi! Sekarang bisa dipindah ke store.`);
            }
        }

        function updateStatusVerification(code, isVerified) {
            const statusRows = document.querySelectorAll('#statusTable tr');
            statusRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === code) {
                    if (isVerified) {
                        // Update verification status
                        row.cells[4].innerHTML = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Terverifikasi</span>';
                        
                        // Enable transfer button
                        const actionCell = row.cells[6];
                        const itemName = row.cells[1].textContent;
                        actionCell.innerHTML = `
                            <button onclick="moveToStore('${code}')" class="text-green-600 hover:text-green-700 mr-3">Pindah ke Store</button>
                            <button onclick="addNoteToStatus('${code}')" class="text-blue-600 hover:text-blue-700">Edit Catatan</button>
                        `;
                    }
                }
            });
        }

        function addToStatus(code, name, quantity, date) {
            const table = document.getElementById('statusTable');
            const newRow = table.insertRow(0);
            newRow.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${code}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${name}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${quantity}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${date}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Menunggu Verifikasi</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Menunggu verifikasi dari incoming</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <button onclick="moveToStore('${code}')" class="text-gray-400 cursor-not-allowed mr-3" disabled title="Menunggu verifikasi dari incoming">Pindah ke Store</button>
                    <button onclick="addNoteToStatus('${code}')" class="text-blue-600 hover:text-blue-700">Edit Catatan</button>
                </td>
            `;
        }

        function removeFromStatus(code) {
            const statusRows = document.querySelectorAll('#statusTable tr');
            statusRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === code) {
                    row.remove();
                }
            });
        }

        function moveToStore(code, targetStore = '01') {
            // Get item details from status or incoming
            let itemName, itemQuantity;
            const statusRows = document.querySelectorAll('#statusTable tr');
            const incomingRows = document.querySelectorAll('#incomingTable tr');
            
            // Find item in status table
            statusRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === code) {
                    itemName = row.cells[1].textContent;
                    itemQuantity = row.cells[2].textContent;
                }
            });
            
            // If not found in status, check incoming
            if (!itemName) {
                incomingRows.forEach(row => {
                    if (row.cells[0] && row.cells[0].textContent === code) {
                        itemName = row.cells[1].textContent;
                        itemQuantity = row.cells[2].textContent;
                    }
                });
            }
            
            if (itemName) {
                // Add to store table
                const storeTable = document.getElementById('storeTable');
                const today = new Date().toISOString().split('T')[0];
                const storeName = storeData[targetStore];
                
                const newRow = storeTable.insertRow(0);
                newRow.setAttribute('data-store', targetStore);
                newRow.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${targetStore}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${storeName}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${itemName}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${itemQuantity}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${today}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Tersedia</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="transferItem(this)" class="text-blue-600 hover:text-blue-700">Transfer</button>
                    </td>
                `;
                
                // Remove from status table
                removeFromStatus(code);
                
                // Add to recent activity
                addActivity(`${itemName} berhasil dipindah ke ${storeName}`, 'green');
                
                alert(`${itemName} berhasil dipindah ke ${storeName}!`);
            }
        }

        // Filter store function
        function filterByStore() {
            const selectedStore = document.getElementById('storeSelector').value;
            const rows = document.querySelectorAll('#storeTable tr[data-store]');
            
            rows.forEach(row => {
                if (selectedStore === '' || row.getAttribute('data-store') === selectedStore) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // History function
        function addToHistory(code, type, name, quantity) {
            const table = document.getElementById('historyTable');
            const newRow = table.insertRow(0);
            const now = new Date();
            const timestamp = now.toISOString().split('T')[0] + ' ' + now.toTimeString().split(' ')[0].substring(0, 5);
            
            const typeClass = type === 'incoming' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800';
            const typeText = type === 'incoming' ? 'Incoming' : 'Outgoing';
            
            newRow.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">TRX${Date.now().toString().slice(-3)}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${typeClass}">${typeText}</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${name}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${quantity}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${timestamp}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Admin</td>
            `;
        }

        // Add to recap function
        function addToRecap(code, name, quantity, unit, minStock) {
            const table = document.getElementById('recapTable');
            const newRow = table.insertRow(0);
            const qty = parseInt(quantity);
            const minStockNum = parseInt(minStock);
            
            let statusStock = '';
            if (qty > minStockNum) {
                statusStock = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Aman</span>';
            } else if (qty === minStockNum) {
                statusStock = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">Minimal</span>';
            } else {
                statusStock = '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">Kurang</span>';
            }
            
            newRow.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${code}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${name}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${quantity}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${unit}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${minStock}</td>
                <td class="px-6 py-4 whitespace-nowrap">${statusStock}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <button onclick="editItem('${code}')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                    <button onclick="deleteItem('${code}')" class="text-red-600 hover:text-red-700">Hapus</button>
                </td>
            `;
        }

        // Activity function
        function addActivity(text, color) {
            const activityContainer = document.getElementById('recentActivity');
            const newActivity = document.createElement('div');
            newActivity.className = 'flex items-start space-x-3';
            newActivity.innerHTML = `
                <div class="w-2 h-2 bg-${color}-500 rounded-full mt-2"></div>
                <div>
                    <p class="text-sm text-gray-900">${text}</p>
                    <p class="text-xs text-gray-500">Baru saja</p>
                </div>
            `;
            activityContainer.insertBefore(newActivity, activityContainer.firstChild);
            
            // Keep only 4 activities
            if (activityContainer.children.length > 4) {
                activityContainer.removeChild(activityContainer.lastChild);
            }
        }

        // Transfer functions
        let currentTransferRow = null;

        function transferItem(button) {
            currentTransferRow = button.closest('tr');
            const itemName = currentTransferRow.cells[2].textContent;
            const currentQty = parseInt(currentTransferRow.cells[3].textContent);
            const currentStore = currentTransferRow.cells[0].textContent;
            
            document.getElementById('transferItemName').value = itemName;
            document.getElementById('availableStock').textContent = currentQty;
            document.getElementById('transferQty').max = currentQty;
            
            // Remove current store from destination options
            const destinationSelect = document.getElementById('transferDestination');
            Array.from(destinationSelect.options).forEach(option => {
                if (option.value === currentStore) {
                    option.style.display = 'none';
                } else {
                    option.style.display = 'block';
                }
            });
            
            document.getElementById('transferModal').classList.remove('hidden');
            document.getElementById('transferModal').classList.add('flex');
        }

        function closeTransferModal() {
            document.getElementById('transferModal').classList.add('hidden');
            document.getElementById('transferModal').classList.remove('flex');
            document.getElementById('transferQty').value = '';
            document.getElementById('transferDestination').value = '';
            currentTransferRow = null;
        }

        function executeTransfer() {
            const transferQty = parseInt(document.getElementById('transferQty').value);
            const destinationStore = document.getElementById('transferDestination').value;
            
            if (!transferQty || !destinationStore) {
                alert('Mohon lengkapi semua field!');
                return;
            }
            
            const availableQty = parseInt(document.getElementById('availableStock').textContent);
            if (transferQty > availableQty) {
                alert('Jumlah transfer melebihi stok yang tersedia!');
                return;
            }
            
            const itemName = currentTransferRow.cells[2].textContent;
            const currentQty = parseInt(currentTransferRow.cells[3].textContent);
            const incomingDate = currentTransferRow.cells[4].textContent;
            const destinationStoreName = storeData[destinationStore];
            
            // Update current row quantity
            const remainingQty = currentQty - transferQty;
            if (remainingQty > 0) {
                currentTransferRow.cells[3].textContent = remainingQty;
            } else {
                // Remove row if no stock left
                currentTransferRow.remove();
            }
            
            // Add to destination store with today's date (outgoing date)
            const storeTable = document.getElementById('storeTable');
            const today = new Date().toISOString().split('T')[0]; // Today's date as outgoing date
            const newRow = storeTable.insertRow(0);
            newRow.setAttribute('data-store', destinationStore);
            newRow.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${destinationStore}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${destinationStoreName}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${itemName}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${transferQty}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${today}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Tersedia</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <button onclick="transferItem(this)" class="text-blue-600 hover:text-blue-700">Transfer</button>
                </td>
            `;
            
            // Add to history
            addToHistory(`TRF${Date.now().toString().slice(-3)}`, 'transfer', `${itemName} (${transferQty} unit ke ${destinationStoreName})`, transferQty);
            
            // Add activity
            addActivity(`Transfer: ${transferQty} unit ${itemName} ke ${destinationStoreName}`, 'blue');
            
            closeTransferModal();
            alert(`Berhasil transfer ${transferQty} unit ${itemName} ke ${destinationStoreName}!`);
        }

        // Notes modal functions
        function addNoteToStatus(code) {
            const statusRows = document.querySelectorAll('#statusTable tr');
            let itemData = null;
            
            statusRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === code) {
                    itemData = {
                        code: row.cells[0].textContent,
                        name: row.cells[1].textContent,
                        note: row.cells[5].textContent
                    };
                }
            });
            
            if (itemData) {
                document.getElementById('noteItemCode').value = itemData.code;
                document.getElementById('noteItemName').value = itemData.name;
                document.getElementById('noteText').value = itemData.note;
                
                document.getElementById('notesModal').classList.remove('hidden');
                document.getElementById('notesModal').classList.add('flex');
            }
        }

        function closeNotesModal() {
            document.getElementById('notesModal').classList.add('hidden');
            document.getElementById('notesModal').classList.remove('flex');
            document.getElementById('noteText').value = '';
        }

        function saveNote() {
            const code = document.getElementById('noteItemCode').value;
            const noteText = document.getElementById('noteText').value.trim();
            
            if (!noteText) {
                alert('Mohon masukkan catatan!');
                return;
            }
            
            // Update the notes column in status table
            const statusRows = document.querySelectorAll('#statusTable tr');
            statusRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === code) {
                    row.cells[5].textContent = noteText;
                }
            });
            
            closeNotesModal();
            addActivity(`Catatan untuk barang ${code} telah diperbarui`, 'blue');
            alert('Catatan berhasil disimpan!');
        }

        // Store management functions
        let currentEditingStore = null;
        let currentEditingUnit = null;

        function openStoreModal() {
            document.getElementById('storeModalTitle').textContent = 'Tambah Store';
            document.getElementById('storeSubmitButton').textContent = 'Tambah';
            document.getElementById('storeCode').readOnly = false;
            document.getElementById('storeCode').classList.remove('bg-gray-100');
            currentEditingStore = null;
            
            document.getElementById('storeModal').classList.remove('hidden');
            document.getElementById('storeModal').classList.add('flex');
        }

        function closeStoreModal() {
            document.getElementById('storeModal').classList.add('hidden');
            document.getElementById('storeModal').classList.remove('flex');
            document.getElementById('storeForm').reset();
        }

        function editStore(storeCode) {
            const storeRows = document.querySelectorAll('#storeSettingsTable tr');
            let storeData = null;
            
            storeRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === storeCode) {
                    storeData = {
                        code: row.cells[0].textContent,
                        name: row.cells[1].textContent
                    };
                }
            });
            
            if (storeData) {
                document.getElementById('storeModalTitle').textContent = 'Edit Store';
                document.getElementById('storeSubmitButton').textContent = 'Simpan';
                document.getElementById('storeCode').value = storeData.code;
                document.getElementById('storeCode').readOnly = true;
                document.getElementById('storeCode').classList.add('bg-gray-100');
                document.getElementById('storeName').value = storeData.name;
                currentEditingStore = storeCode;
                
                document.getElementById('storeModal').classList.remove('hidden');
                document.getElementById('storeModal').classList.add('flex');
            }
        }

        function saveStore() {
            const code = document.getElementById('storeCode').value.trim();
            const name = document.getElementById('storeName').value.trim();
            
            if (!code || !name) {
                alert('Mohon lengkapi semua field!');
                return;
            }
            
            if (currentEditingStore) {
                // Edit existing store
                const storeRows = document.querySelectorAll('#storeSettingsTable tr');
                storeRows.forEach(row => {
                    if (row.cells[0] && row.cells[0].textContent === currentEditingStore) {
                        row.cells[1].textContent = name;
                    }
                });
                
                // Update storeData object
                storeData[code] = name;
                
                addActivity(`Store ${code} berhasil diupdate`, 'blue');
                alert(`Store ${code} berhasil diupdate!`);
            } else {
                // Add new store
                const table = document.getElementById('storeSettingsTable');
                const newRow = table.insertRow(0);
                newRow.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${code}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editStore('${code}')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                        <button onclick="deleteStore('${code}')" class="text-red-600 hover:text-red-700">Hapus</button>
                    </td>
                `;
                
                // Add to storeData object
                storeData[code] = name;
                
                // Update all store selectors
                updateStoreSelectors();
                
                addActivity(`Store baru ${code} - ${name} berhasil ditambahkan`, 'green');
                alert(`Store ${code} berhasil ditambahkan!`);
            }
            
            closeStoreModal();
        }

        function deleteStore(storeCode) {
            if (confirm(`Apakah Anda yakin ingin menghapus store ${storeCode}?`)) {
                const storeRows = document.querySelectorAll('#storeSettingsTable tr');
                let storeName = '';
                
                storeRows.forEach(row => {
                    if (row.cells[0] && row.cells[0].textContent === storeCode) {
                        storeName = row.cells[1].textContent;
                        row.remove();
                    }
                });
                
                // Remove from storeData object
                delete storeData[storeCode];
                
                // Update all store selectors
                updateStoreSelectors();
                
                if (storeName) {
                    addActivity(`Store ${storeCode} - ${storeName} berhasil dihapus`, 'red');
                    alert(`Store ${storeCode} berhasil dihapus!`);
                }
            }
        }

        function updateStoreSelectors() {
            const selectors = ['storeSelector', 'itemStore', 'transferDestination'];
            
            selectors.forEach(selectorId => {
                const selector = document.getElementById(selectorId);
                if (selector) {
                    // Save current value
                    const currentValue = selector.value;
                    
                    // Clear existing options (except first one)
                    while (selector.children.length > 1) {
                        selector.removeChild(selector.lastChild);
                    }
                    
                    // Add updated options
                    Object.keys(storeData).forEach(code => {
                        const option = document.createElement('option');
                        option.value = code;
                        option.textContent = `${code} - ${storeData[code]}`;
                        selector.appendChild(option);
                    });
                    
                    // Restore value if still exists
                    if (storeData[currentValue]) {
                        selector.value = currentValue;
                    }
                }
            });
        }

        // Unit management functions
        function openUnitModal() {
            document.getElementById('unitModalTitle').textContent = 'Tambah Unit';
            document.getElementById('unitSubmitButton').textContent = 'Tambah';
            document.getElementById('unitName').readOnly = false;
            document.getElementById('unitName').classList.remove('bg-gray-100');
            currentEditingUnit = null;
            
            document.getElementById('unitModal').classList.remove('hidden');
            document.getElementById('unitModal').classList.add('flex');
        }

        function closeUnitModal() {
            document.getElementById('unitModal').classList.add('hidden');
            document.getElementById('unitModal').classList.remove('flex');
            document.getElementById('unitForm').reset();
        }

        function editUnit(unitName) {
            const unitRows = document.querySelectorAll('#unitSettingsTable tr');
            let unitData = null;
            
            unitRows.forEach(row => {
                if (row.cells[0] && row.cells[0].textContent === unitName) {
                    unitData = {
                        name: row.cells[0].textContent,
                        description: row.cells[1].textContent
                    };
                }
            });
            
            if (unitData) {
                document.getElementById('unitModalTitle').textContent = 'Edit Unit';
                document.getElementById('unitSubmitButton').textContent = 'Simpan';
                document.getElementById('unitName').value = unitData.name;
                document.getElementById('unitName').readOnly = true;
                document.getElementById('unitName').classList.add('bg-gray-100');
                document.getElementById('unitDescription').value = unitData.description;
                currentEditingUnit = unitName;
                
                document.getElementById('unitModal').classList.remove('hidden');
                document.getElementById('unitModal').classList.add('flex');
            }
        }

        function saveUnit() {
            const name = document.getElementById('unitName').value.trim();
            const description = document.getElementById('unitDescription').value.trim();
            
            if (!name || !description) {
                alert('Mohon lengkapi semua field!');
                return;
            }
            
            if (currentEditingUnit) {
                // Edit existing unit
                const unitRows = document.querySelectorAll('#unitSettingsTable tr');
                unitRows.forEach(row => {
                    if (row.cells[0] && row.cells[0].textContent === currentEditingUnit) {
                        row.cells[1].textContent = description;
                    }
                });
                
                addActivity(`Unit ${name} berhasil diupdate`, 'blue');
                alert(`Unit ${name} berhasil diupdate!`);
            } else {
                // Add new unit
                const table = document.getElementById('unitSettingsTable');
                const newRow = table.insertRow(0);
                newRow.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${description}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editUnit('${name}')" class="text-blue-600 hover:text-blue-700 mr-3">Edit</button>
                        <button onclick="deleteUnit('${name}')" class="text-red-600 hover:text-red-700">Hapus</button>
                    </td>
                `;
                
                // Update all unit selectors
                updateUnitSelectors(name);
                
                addActivity(`Unit baru ${name} berhasil ditambahkan`, 'green');
                alert(`Unit ${name} berhasil ditambahkan!`);
            }
            
            closeUnitModal();
        }

        function deleteUnit(unitName) {
            if (confirm(`Apakah Anda yakin ingin menghapus unit ${unitName}?`)) {
                const unitRows = document.querySelectorAll('#unitSettingsTable tr');
                
                unitRows.forEach(row => {
                    if (row.cells[0] && row.cells[0].textContent === unitName) {
                        row.remove();
                    }
                });
                
                // Remove from all unit selectors
                removeUnitFromSelectors(unitName);
                
                addActivity(`Unit ${unitName} berhasil dihapus`, 'red');
                alert(`Unit ${unitName} berhasil dihapus!`);
            }
        }

        function updateUnitSelectors(newUnit) {
            const selectors = ['itemUnit', 'editItemUnit'];
            
            selectors.forEach(selectorId => {
                const selector = document.getElementById(selectorId);
                if (selector) {
                    const option = document.createElement('option');
                    option.value = newUnit;
                    option.textContent = newUnit;
                    selector.appendChild(option);
                }
            });
        }

        function removeUnitFromSelectors(unitName) {
            const selectors = ['itemUnit', 'editItemUnit'];
            
            selectors.forEach(selectorId => {
                const selector = document.getElementById(selectorId);
                if (selector) {
                    Array.from(selector.options).forEach(option => {
                        if (option.value === unitName) {
                            option.remove();
                        }
                    });
                }
            });
        }

        // Export functions
        function exportRecap() {
            const format = document.querySelector('input[name="recapFormat"]:checked').value;
            const statusFilter = document.getElementById('recapStatusFilter').value;
            
            // Get data from recap table
            const recapRows = document.querySelectorAll('#recapTable tr');
            let exportData = [];
            
            recapRows.forEach(row => {
                if (row.cells && row.cells.length > 0) {
                    const statusText = row.cells[5].textContent.toLowerCase();
                    const shouldInclude = statusFilter === 'all' || 
                        (statusFilter === 'aman' && statusText.includes('aman')) ||
                        (statusFilter === 'minimal' && statusText.includes('minimal')) ||
                        (statusFilter === 'kurang' && statusText.includes('kurang'));
                    
                    if (shouldInclude) {
                        exportData.push({
                            kode: row.cells[0].textContent,
                            nama: row.cells[1].textContent,
                            qty: row.cells[2].textContent,
                            unit: row.cells[3].textContent,
                            minStock: row.cells[4].textContent,
                            status: row.cells[5].textContent.replace(/\s+/g, ' ').trim()
                        });
                    }
                }
            });
            
            const today = new Date().toISOString().split('T')[0];
            const timestamp = new Date().toLocaleString('id-ID');
            
            if (format === 'excel') {
                exportToExcel(exportData, `Rekapitulasi_${today}`, 'rekapitulasi');
            } else {
                exportToPDF(exportData, `Rekapitulasi_${today}`, 'rekapitulasi');
            }
            
            // Add to export history
            addToExportHistory(`Rekapitulasi_${today}.${format === 'excel' ? 'xlsx' : 'pdf'}`, 'Rekapitulasi', format === 'excel' ? 'Excel' : 'PDF');
            
            addActivity(`Export rekapitulasi berhasil (${format.toUpperCase()})`, 'green');
            alert(`Export rekapitulasi berhasil! File ${format.toUpperCase()} telah didownload.`);
        }

        function exportStore() {
            const selectedStore = document.getElementById('exportStoreSelector').value;
            const format = document.querySelector('input[name="storeFormat"]:checked').value;
            
            // Get data from store table
            const storeRows = document.querySelectorAll('#storeTable tr[data-store]');
            let exportData = [];
            
            storeRows.forEach(row => {
                const storeCode = row.getAttribute('data-store');
                if (selectedStore === 'all' || storeCode === selectedStore) {
                    exportData.push({
                        kodeStore: row.cells[0].textContent,
                        namaStore: row.cells[1].textContent,
                        namaBarang: row.cells[2].textContent,
                        qty: row.cells[3].textContent,
                        tanggalIncoming: row.cells[4].textContent,
                        status: row.cells[5].textContent.replace(/\s+/g, ' ').trim()
                    });
                }
            });
            
            const today = new Date().toISOString().split('T')[0];
            const storeName = selectedStore === 'all' ? 'Semua_Store' : `Store_${selectedStore}`;
            const fileName = `${storeName}_${today}`;
            
            if (format === 'excel') {
                exportStoreToExcel(exportData, fileName, selectedStore);
            } else {
                exportStoreToPDF(exportData, fileName, selectedStore);
            }
            
            // Add to export history
            addToExportHistory(`${fileName}.${format === 'excel' ? 'xlsx' : 'pdf'}`, 'Kartu Store', format === 'excel' ? 'Excel' : 'PDF');
            
            addActivity(`Export kartu store berhasil (${format.toUpperCase()})`, 'blue');
            alert(`Export kartu store berhasil! File ${format.toUpperCase()} telah didownload.`);
        }

        function exportToExcel(data, filename, type) {
            // Create CSV content for Excel compatibility
            let csvContent = '';
            
            if (type === 'rekapitulasi') {
                csvContent = 'Kode Barang,Nama Barang,Qty,Unit,Min Stock,Status Stock\n';
                data.forEach(item => {
                    csvContent += `"${item.kode}","${item.nama}","${item.qty}","${item.unit}","${item.minStock}","${item.status}"\n`;
                });
            }
            
            // Create and download file
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename + '.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function exportStoreToExcel(data, filename, storeCode) {
            let csvContent = 'Kode Store,Nama Store,Nama Barang,Qty,Tanggal Incoming,Status\n';
            data.forEach(item => {
                csvContent += `"${item.kodeStore}","${item.namaStore}","${item.namaBarang}","${item.qty}","${item.tanggalIncoming}","${item.status}"\n`;
            });
            
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename + '.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function exportToPDF(data, filename, type) {
            // Create HTML content for PDF
            let htmlContent = `
                <html>
                <head>
                    <meta charset="utf-8">
                    <title>${filename}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .company { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
                        .title { font-size: 16px; margin-bottom: 20px; }
                        .date { font-size: 12px; color: #666; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 12px; }
                        th { background-color: #f5f5f5; font-weight: bold; }
                        .footer { margin-top: 30px; font-size: 10px; color: #666; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <div class="company">ðŸ“¦ ModernStock</div>
                        <div class="title">Laporan ${type === 'rekapitulasi' ? 'Rekapitulasi Inventori' : 'Kartu Store'}</div>
                        <div class="date">Tanggal: ${new Date().toLocaleDateString('id-ID')}</div>
                    </div>
                    <table>
            `;
            
            if (type === 'rekapitulasi') {
                htmlContent += `
                    <thead>
                        <tr>
                            <th>Kode Barang</th>
                            <th>Nama Barang</th>
                            <th>Qty</th>
                            <th>Unit</th>
                            <th>Min Stock</th>
                            <th>Status Stock</th>
                        </tr>
                    </thead>
                    <tbody>
                `;
                data.forEach(item => {
                    htmlContent += `
                        <tr>
                            <td>${item.kode}</td>
                            <td>${item.nama}</td>
                            <td>${item.qty}</td>
                            <td>${item.unit}</td>
                            <td>${item.minStock}</td>
                            <td>${item.status}</td>
                        </tr>
                    `;
                });
            }
            
            htmlContent += `
                    </tbody>
                </table>
                <div class="footer">
                    <p>Dicetak pada: ${new Date().toLocaleString('id-ID')}</p>
                    <p>ModernStock - Sistem Manajemen Gudang</p>
                </div>
            </body>
            </html>
            `;
            
            // Create and download PDF (using print functionality)
            const printWindow = window.open('', '_blank');
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            printWindow.focus();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 250);
        }

        function exportStoreToPDF(data, filename, storeCode) {
            const storeName = storeCode === 'all' ? 'Semua Store' : storeData[storeCode] || `Store ${storeCode}`;
            
            let htmlContent = `
                <html>
                <head>
                    <meta charset="utf-8">
                    <title>${filename}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .company { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
                        .title { font-size: 16px; margin-bottom: 10px; }
                        .store-info { font-size: 14px; margin-bottom: 20px; }
                        .date { font-size: 12px; color: #666; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 12px; }
                        th { background-color: #f5f5f5; font-weight: bold; }
                        .footer { margin-top: 30px; font-size: 10px; color: #666; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <div class="company">ðŸ“¦ ModernStock</div>
                        <div class="title">Laporan Kartu Store</div>
                        <div class="store-info">Store: ${storeName}</div>
                        <div class="date">Tanggal: ${new Date().toLocaleDateString('id-ID')}</div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Kode Store</th>
                                <th>Nama Store</th>
                                <th>Nama Barang</th>
                                <th>Qty</th>
                                <th>Tanggal Incoming</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            data.forEach(item => {
                htmlContent += `
                    <tr>
                        <td>${item.kodeStore}</td>
                        <td>${item.namaStore}</td>
                        <td>${item.namaBarang}</td>
                        <td>${item.qty}</td>
                        <td>${item.tanggalIncoming}</td>
                        <td>${item.status}</td>
                    </tr>
                `;
            });
            
            htmlContent += `
                        </tbody>
                    </table>
                    <div class="footer">
                        <p>Total Item: ${data.length}</p>
                        <p>Dicetak pada: ${new Date().toLocaleString('id-ID')}</p>
                        <p>ModernStock - Sistem Manajemen Gudang</p>
                    </div>
                </body>
                </html>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            printWindow.focus();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 250);
        }

        function addToExportHistory(filename, type, format) {
            const table = document.getElementById('exportHistoryTable');
            const newRow = table.insertRow(0);
            const now = new Date();
            const timestamp = now.toISOString().split('T')[0] + ' ' + now.toTimeString().split(' ')[0].substring(0, 5);
            
            newRow.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${filename}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${type}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${format}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${timestamp}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Berhasil</span>
                </td>
            `;
            
            // Keep only last 10 exports
            if (table.rows.length > 10) {
                table.deleteRow(table.rows.length - 1);
            }
        }

        // Close modal when clicking outside
        document.getElementById('addModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        document.getElementById('transferModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeTransferModal();
            }
        });

        document.getElementById('editModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeEditModal();
            }
        });

        document.getElementById('notesModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeNotesModal();
            }
        });

        document.getElementById('storeModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeStoreModal();
            }
        });

        document.getElementById('unitModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeUnitModal();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97f15b27156b9b90',t:'MTc1Nzg2ODM0MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
