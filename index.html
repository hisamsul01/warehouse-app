<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Manajemen Gudang</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        .sidebar-transition { transition: all 0.3s ease-in-out; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .hover-scale { transition: transform 0.2s; }
        .hover-scale:hover { transform: scale(1.02); }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <header class="bg-white shadow-lg border-b-4 border-blue-500 fixed w-full top-0 z-50">
        <div class="flex items-center justify-between px-6 py-4">
            <div class="flex items-center space-x-4">
                <button id="sidebarToggle" class="text-gray-600 hover:text-blue-600 transition-colors">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <h1 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-warehouse text-blue-600 mr-2"></i>
                    Sistem Manajemen Gudang
                </h1>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-sm text-gray-600">
                    <i class="fas fa-user-circle mr-1"></i>
                    Admin User
                </div>
                <button class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-sign-out-alt mr-1"></i>
                    Logout
                </button>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside id="sidebar" class="fixed left-0 top-16 h-full w-64 bg-white shadow-xl sidebar-transition z-40 border-r border-gray-200">
        <nav class="p-4">
            <ul class="space-y-2">
                <li>
                    <button onclick="showSection('dashboard')" class="menu-item w-full flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all">
                        <i class="fas fa-tachometer-alt w-5"></i>
                        <span>Dashboard</span>
                    </button>
                </li>
                <li>
                    <button onclick="showSection('penerimaan')" class="menu-item w-full flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all">
                        <i class="fas fa-truck-loading w-5"></i>
                        <span>Penerimaan Barang</span>
                    </button>
                </li>
                <li>
                    <button onclick="showSection('transfer')" class="menu-item w-full flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all">
                        <i class="fas fa-exchange-alt w-5"></i>
                        <span>Transfer to Outlet</span>
                    </button>
                </li>
                <li>
                    <button onclick="showSection('riwayat')" class="menu-item w-full flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all">
                        <i class="fas fa-history w-5"></i>
                        <span>Riwayat</span>
                    </button>
                </li>
                <li>
                    <button onclick="showSection('outlet')" class="menu-item w-full flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all">
                        <i class="fas fa-store w-5"></i>
                        <span>Outlet</span>
                    </button>
                </li>
                <li>
                    <button onclick="showSection('database')" class="menu-item w-full flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all">
                        <i class="fas fa-database w-5"></i>
                        <span>Database</span>
                    </button>
                </li>
                <li>
                    <button onclick="showSection('laporan')" class="menu-item w-full flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all">
                        <i class="fas fa-chart-bar w-5"></i>
                        <span>Laporan</span>
                    </button>
                </li>
                <li>
                    <button onclick="showSection('pengaturan')" class="menu-item w-full flex items-center space-x-3 px-4 py-3 text-gray-700 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all">
                        <i class="fas fa-cog w-5"></i>
                        <span>Pengaturan</span>
                    </button>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main id="mainContent" class="ml-64 mt-16 p-6 sidebar-transition">
        <!-- Dashboard Section -->
        <div id="dashboard" class="section fade-in">
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Dashboard</h2>
                <p class="text-gray-600">Selamat datang di Sistem Manajemen Gudang</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-xl shadow-lg hover-scale">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100">Total Barang</p>
                            <p class="text-3xl font-bold">1,234</p>
                        </div>
                        <i class="fas fa-boxes text-4xl text-blue-200"></i>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-xl shadow-lg hover-scale">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100">Penerimaan Hari Ini</p>
                            <p class="text-3xl font-bold">45</p>
                        </div>
                        <i class="fas fa-truck text-4xl text-green-200"></i>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-orange-500 to-orange-600 text-white p-6 rounded-xl shadow-lg hover-scale">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-orange-100">Transfer Hari Ini</p>
                            <p class="text-3xl font-bold">23</p>
                        </div>
                        <i class="fas fa-shipping-fast text-4xl text-orange-200"></i>
                    </div>
                </div>
                <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-xl shadow-lg hover-scale">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-100">Total Outlet</p>
                            <p class="text-3xl font-bold">8</p>
                        </div>
                        <i class="fas fa-store text-4xl text-purple-200"></i>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 text-gray-800">Aktivitas Terbaru</h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                            <i class="fas fa-plus-circle text-green-500"></i>
                            <div>
                                <p class="font-medium">Penerimaan Barang BRG001</p>
                                <p class="text-sm text-gray-600">2 menit yang lalu</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                            <i class="fas fa-arrow-right text-blue-500"></i>
                            <div>
                                <p class="font-medium">Transfer ke Outlet Jakarta</p>
                                <p class="text-sm text-gray-600">15 menit yang lalu</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 text-gray-800">Status Koneksi Spreadsheet</h3>
                    <div class="connection-status">
                        <div class="flex items-center space-x-3 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                            <i class="fas fa-sync-alt text-yellow-500 text-xl animate-spin"></i>
                            <div>
                                <p class="font-medium text-yellow-800">Menghubungkan...</p>
                                <p class="text-sm text-yellow-600">Sedang testing koneksi</p>
                            </div>
                        </div>
                    </div>
                    <button onclick="testConnection()" class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-plug mr-2"></i>Test Koneksi
                    </button>
                </div>
            </div>
        </div>

        <!-- Penerimaan Barang Section -->
        <div id="penerimaan" class="section hidden">
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Penerimaan Barang</h2>
                <p class="text-gray-600">Kelola penerimaan barang masuk ke gudang</p>
            </div>

            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-xl font-semibold mb-4">Tambah Penerimaan Baru</h3>
                <form id="penerimaanForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal</label>
                        <input type="date" id="tglPenerimaan" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kode Barang</label>
                        <input type="text" id="kodePenerimaan" placeholder="BRG001" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nama Barang</label>
                        <input type="text" id="namaPenerimaan" placeholder="Nama barang" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Quantity</label>
                        <input type="number" id="qtyPenerimaan" placeholder="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Unit</label>
                        <select id="unitPenerimaan" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="pcs">Pcs</option>
                            <option value="kg">Kg</option>
                            <option value="liter">Liter</option>
                            <option value="box">Box</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                        <select id="statusPenerimaan" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="diterima">Diterima</option>
                            <option value="pending">Pending</option>
                            <option value="ditolak">Ditolak</option>
                        </select>
                    </div>
                    <div class="md:col-span-3">
                        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-plus mr-2"></i>Tambah Penerimaan
                        </button>
                    </div>
                </form>
            </div>

            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-xl font-semibold">Data Penerimaan</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tanggal</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kode Barang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Barang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quantity</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Unit</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="penerimaanTable" class="bg-white divide-y divide-gray-200">
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Transfer Section -->
        <div id="transfer" class="section hidden">
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Transfer to Outlet</h2>
                <p class="text-gray-600">Kelola transfer barang ke outlet</p>
            </div>

            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-xl font-semibold mb-4">Tambah Transfer Baru</h3>
                <form id="transferForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal</label>
                        <input type="date" id="tglTransfer" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kode Barang</label>
                        <input type="text" id="kodeTransfer" placeholder="BRG001" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nama Barang</label>
                        <input type="text" id="namaTransfer" placeholder="Nama barang" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Quantity</label>
                        <input type="number" id="qtyTransfer" placeholder="50" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Unit</label>
                        <select id="unitTransfer" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="pcs">Pcs</option>
                            <option value="kg">Kg</option>
                            <option value="liter">Liter</option>
                            <option value="box">Box</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Outlet</label>
                        <select id="outletTransfer" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="OUT001">Jakarta Pusat</option>
                            <option value="OUT002">Jakarta Selatan</option>
                            <option value="OUT003">Bandung</option>
                        </select>
                    </div>
                    <div class="md:col-span-3">
                        <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-paper-plane mr-2"></i>Proses Transfer
                        </button>
                    </div>
                </form>
            </div>

            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-xl font-semibold">Data Transfer</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tanggal</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kode Barang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Barang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quantity</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Unit</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Outlet</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="transferTable" class="bg-white divide-y divide-gray-200">
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Riwayat Section -->
        <div id="riwayat" class="section hidden">
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Riwayat Aktivitas</h2>
                <p class="text-gray-600">Log aktivitas semua transaksi barang</p>
            </div>

            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-xl font-semibold">Log Aktivitas</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tanggal</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kode Barang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Barang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Keterangan</th>
                            </tr>
                        </thead>
                        <tbody id="riwayatTable" class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-01-15</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">BRG001</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Laptop Dell</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                        Penerimaan barang - 10 pcs
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-01-15</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">BRG001</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Laptop Dell</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">
                                        Transfer ke Jakarta Pusat - 5 pcs
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Outlet Section -->
        <div id="outlet" class="section hidden">
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Manajemen Outlet</h2>
                <p class="text-gray-600">Kelola data outlet dan cabang</p>
            </div>

            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-xl font-semibold mb-4">Tambah Outlet Baru</h3>
                <form id="outletForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kode Outlet</label>
                        <input type="text" id="kodeOutlet" placeholder="OUT001" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nama Outlet</label>
                        <input type="text" id="namaOutlet" placeholder="Jakarta Pusat" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div class="md:col-span-2">
                        <button type="submit" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-plus mr-2"></i>Tambah Outlet
                        </button>
                    </div>
                </form>
            </div>

            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-xl font-semibold">Data Outlet</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kode Outlet</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Outlet</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="outletTable" class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">OUT001</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Jakarta Pusat</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                    <button class="text-blue-600 hover:text-blue-900">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="text-red-600 hover:text-red-900">
                                        <i class="fas fa-trash"></i> Hapus
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">OUT002</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Jakarta Selatan</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                    <button class="text-blue-600 hover:text-blue-900">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="text-red-600 hover:text-red-900">
                                        <i class="fas fa-trash"></i> Hapus
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Database Section -->
        <div id="database" class="section hidden">
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Database Barang</h2>
                <p class="text-gray-600">Kelola master data barang dan stok</p>
            </div>

            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-xl font-semibold mb-4">Tambah Barang Baru</h3>
                <form id="databaseForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kode Barang</label>
                        <input type="text" id="kodeDatabase" placeholder="BRG001" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nama Barang</label>
                        <input type="text" id="namaDatabase" placeholder="Nama barang" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Stock</label>
                        <input type="number" id="stockDatabase" placeholder="100" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Unit</label>
                        <select id="unitDatabase" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="pcs">Pcs</option>
                            <option value="kg">Kg</option>
                            <option value="liter">Liter</option>
                            <option value="box">Box</option>
                        </select>
                    </div>
                    <div class="lg:col-span-4">
                        <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-plus mr-2"></i>Tambah Barang
                        </button>
                    </div>
                </form>
            </div>

            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-xl font-semibold">Master Data Barang</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kode Barang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Barang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Unit</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="databaseTable" class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">BRG001</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Laptop Dell</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">25</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Pcs</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                    <button class="text-blue-600 hover:text-blue-900">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="text-red-600 hover:text-red-900">
                                        <i class="fas fa-trash"></i> Hapus
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Laporan Section -->
        <div id="laporan" class="section hidden">
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Laporan</h2>
                <p class="text-gray-600">Generate dan download laporan dalam format PDF atau Excel</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4">Download Laporan</h3>
                    <div class="space-y-4">
                        <button onclick="downloadPDF()" class="w-full bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg transition-colors flex items-center justify-center">
                            <i class="fas fa-file-pdf mr-2"></i>Download PDF
                        </button>
                        <button onclick="downloadExcel()" class="w-full bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg transition-colors flex items-center justify-center">
                            <i class="fas fa-file-excel mr-2"></i>Download Excel
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4">Filter Laporan</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Dari Tanggal</label>
                            <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Sampai Tanggal</label>
                            <input type="date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-xl font-semibold">Preview Laporan</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Kode Barang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nama Barang</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Unit</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">BRG001</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Laptop Dell</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">25</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Pcs</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">BRG002</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Mouse Wireless</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">150</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Pcs</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Pengaturan Section -->
        <div id="pengaturan" class="section hidden">
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Pengaturan</h2>
                <p class="text-gray-600">Konfigurasi sistem dan preferensi pengguna</p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4">Tampilan</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tema</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="light">Light</option>
                                <option value="dark">Dark</option>
                                <option value="auto">Auto</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Font</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="sans">Sans Serif</option>
                                <option value="serif">Serif</option>
                                <option value="mono">Monospace</option>
                            </select>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="animations" class="mr-2">
                            <label for="animations" class="text-sm text-gray-700">Aktifkan Animasi</label>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4">Bahasa & Regional</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Bahasa</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="id">Bahasa Indonesia</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Format Tanggal</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="dd/mm/yyyy">DD/MM/YYYY</option>
                                <option value="mm/dd/yyyy">MM/DD/YYYY</option>
                                <option value="yyyy-mm-dd">YYYY-MM-DD</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4">User Login</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                            <input type="text" value="admin" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Password Baru</label>
                            <input type="password" placeholder="Masukkan password baru" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <button class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-save mr-2"></i>Simpan Perubahan
                        </button>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-semibold mb-4">Integrasi Spreadsheet</h3>
                    <div class="space-y-4">
                        <div class="connection-status">
                            <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                                <div class="flex items-center">
                                    <i class="fas fa-sync-alt text-yellow-500 mr-2 animate-spin"></i>
                                    <span class="text-yellow-800 font-medium">Status: Menghubungkan...</span>
                                </div>
                                <p class="text-sm text-yellow-600 mt-1">Sedang testing koneksi ke spreadsheet</p>
                            </div>
                        </div>
                        <button onclick="testConnection()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-sync mr-2"></i>Test Koneksi
                        </button>
                        <button onclick="syncAllData()" class="w-full bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg transition-colors">
                            <i class="fas fa-sync mr-2"></i>Sinkronisasi Manual
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Google Apps Script Web App URL
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwlfkdlalFJd16Kj_GM2Hox0e3n8rMsCJpuzXuTkwpB1cn6EQRWzjiwCw7QSNLbWePz/exec';
        
        // Data storage
        let penerimaanData = [];
        let transferData = [];
        let outletData = [
            { kode: 'OUT001', nama: 'Jakarta Pusat' },
            { kode: 'OUT002', nama: 'Jakarta Selatan' },
            { kode: 'OUT003', nama: 'Bandung' }
        ];
        let databaseData = [
            { kode: 'BRG001', nama: 'Laptop Dell', stock: 25, unit: 'pcs' },
            { kode: 'BRG002', nama: 'Mouse Wireless', stock: 150, unit: 'pcs' }
        ];

        // Function to send data to Google Sheets
        async function sendToGoogleSheets(action, data) {
            try {
                showNotification('Menyinkronkan data ke spreadsheet...', 'info');
                
                const formData = new FormData();
                formData.append('action', action);
                
                // Add all data fields to FormData
                Object.keys(data).forEach(key => {
                    formData.append(key, data[key]);
                });
                
                const response = await fetch(WEB_APP_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: formData
                });
                
                // Since we're using no-cors, we can't read the response
                // But we assume success if no error is thrown
                showNotification('✅ Data berhasil dikirim ke spreadsheet!', 'success');
                updateConnectionStatus(true);
                
                return { success: true };
            } catch (error) {
                console.error('Error syncing to Google Sheets:', error);
                showNotification('⚠️ Data disimpan lokal, akan sync otomatis nanti', 'info');
                updateConnectionStatus(false);
                return { success: false, message: error.message };
            }
        }

        // Function to load data from Google Sheets
        async function loadFromGoogleSheets(action) {
            try {
                const response = await fetch(WEB_APP_URL + '?action=' + action, {
                    method: 'GET',
                    mode: 'cors'
                });
                
                if (response.ok) {
                    const result = await response.json();
                    updateConnectionStatus(true);
                    return result.data || [];
                } else {
                    updateConnectionStatus(false);
                    return [];
                }
            } catch (error) {
                console.error('Error loading from Google Sheets:', error);
                updateConnectionStatus(false);
                return [];
            }
        }

        // Function to update connection status
        function updateConnectionStatus(isConnected) {
            const statusElements = document.querySelectorAll('.connection-status');
            statusElements.forEach(statusElement => {
                if (isConnected) {
                    statusElement.innerHTML = `
                        <div class="flex items-center space-x-3 p-4 bg-green-50 border border-green-200 rounded-lg">
                            <i class="fas fa-check-circle text-green-500 text-xl"></i>
                            <div>
                                <p class="font-medium text-green-800">Terhubung</p>
                                <p class="text-sm text-green-600">Sinkronisasi real-time aktif</p>
                            </div>
                        </div>
                    `;
                } else {
                    statusElement.innerHTML = `
                        <div class="flex items-center space-x-3 p-4 bg-red-50 border border-red-200 rounded-lg">
                            <i class="fas fa-times-circle text-red-500 text-xl"></i>
                            <div>
                                <p class="font-medium text-red-800">Terputus</p>
                                <p class="text-sm text-red-600">Gagal terhubung ke spreadsheet</p>
                            </div>
                        </div>
                    `;
                }
            });
        }

        // Function to test connection
        async function testConnection() {
            showNotification('Testing koneksi ke spreadsheet...', 'info');
            
            try {
                // Try to send a simple test request
                const formData = new FormData();
                formData.append('action', 'test');
                formData.append('timestamp', new Date().toISOString());
                
                const response = await fetch(WEB_APP_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    body: formData
                });
                
                // If no error is thrown, assume connection is working
                showNotification('✅ Koneksi berhasil! Spreadsheet terhubung', 'success');
                updateConnectionStatus(true);
                
            } catch (error) {
                console.error('Connection test failed:', error);
                showNotification('⚠️ Koneksi tidak stabil, data akan disimpan lokal', 'info');
                updateConnectionStatus(false);
            }
        }

        // Function to sync all data
        async function syncAllData() {
            showNotification('Memulai sinkronisasi semua data...', 'info');
            
            // Sync all penerimaan data
            for (const item of penerimaanData) {
                await sendToGoogleSheets('addPenerimaan', item);
            }
            
            // Sync all transfer data
            for (const item of transferData) {
                await sendToGoogleSheets('addTransfer', item);
            }
            
            // Sync all outlet data
            for (const item of outletData) {
                await sendToGoogleSheets('addOutlet', item);
            }
            
            // Sync all database data
            for (const item of databaseData) {
                await sendToGoogleSheets('addDatabase', item);
            }
            
            showNotification('✅ Sinkronisasi semua data selesai!', 'success');
        }

        // Sidebar toggle
        document.getElementById('sidebarToggle').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            if (sidebar.style.transform === 'translateX(-100%)') {
                sidebar.style.transform = 'translateX(0)';
                mainContent.style.marginLeft = '16rem';
            } else {
                sidebar.style.transform = 'translateX(-100%)';
                mainContent.style.marginLeft = '0';
            }
        });

        // Show section function
        function showSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(sectionName).classList.remove('hidden');
            
            // Update active menu
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => {
                item.classList.remove('bg-blue-50', 'text-blue-600');
            });
            event.target.classList.add('bg-blue-50', 'text-blue-600');
        }

        // Set today's date as default
        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('tglPenerimaan').value = today;
            document.getElementById('tglTransfer').value = today;
        }

        // Form submissions with Google Sheets integration
        document.getElementById('penerimaanForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const data = {
                tanggal: document.getElementById('tglPenerimaan').value,
                kode: document.getElementById('kodePenerimaan').value,
                nama: document.getElementById('namaPenerimaan').value,
                qty: document.getElementById('qtyPenerimaan').value,
                unit: document.getElementById('unitPenerimaan').value,
                status: document.getElementById('statusPenerimaan').value
            };
            
            // Add to local data
            penerimaanData.push(data);
            updatePenerimaanTable();
            addToRiwayat(data.tanggal, data.kode, data.nama, `Penerimaan barang - ${data.qty} ${data.unit}`);
            
            // Save to localStorage immediately
            saveLocalData();
            
            // Send to Google Sheets
            await sendToGoogleSheets('addPenerimaan', data);
            
            this.reset();
            setTodayDate();
        });

        document.getElementById('transferForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const data = {
                tanggal: document.getElementById('tglTransfer').value,
                kode: document.getElementById('kodeTransfer').value,
                nama: document.getElementById('namaTransfer').value,
                qty: document.getElementById('qtyTransfer').value,
                unit: document.getElementById('unitTransfer').value,
                outlet: document.getElementById('outletTransfer').value
            };
            
            // Add to local data
            transferData.push(data);
            updateTransferTable();
            addToRiwayat(data.tanggal, data.kode, data.nama, `Transfer ke ${data.outlet} - ${data.qty} ${data.unit}`);
            
            // Save to localStorage immediately
            saveLocalData();
            
            // Send to Google Sheets
            await sendToGoogleSheets('addTransfer', data);
            
            this.reset();
            setTodayDate();
        });

        document.getElementById('outletForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const data = {
                kode: document.getElementById('kodeOutlet').value,
                nama: document.getElementById('namaOutlet').value
            };
            
            // Add to local data
            outletData.push(data);
            updateOutletTable();
            updateOutletSelect();
            
            // Save to localStorage immediately
            saveLocalData();
            
            // Send to Google Sheets
            await sendToGoogleSheets('addOutlet', data);
            
            this.reset();
        });

        document.getElementById('databaseForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const data = {
                kode: document.getElementById('kodeDatabase').value,
                nama: document.getElementById('namaDatabase').value,
                stock: document.getElementById('stockDatabase').value,
                unit: document.getElementById('unitDatabase').value
            };
            
            // Add to local data
            databaseData.push(data);
            updateDatabaseTable();
            
            // Save to localStorage immediately
            saveLocalData();
            
            // Send to Google Sheets
            await sendToGoogleSheets('addDatabase', data);
            
            this.reset();
        });

        // Update table functions
        function updatePenerimaanTable() {
            const tbody = document.getElementById('penerimaanTable');
            tbody.innerHTML = penerimaanData.map(item => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.tanggal}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.kode}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.nama}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.qty}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.unit}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(item.status)}">
                            ${item.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                        <button class="text-blue-600 hover:text-blue-900">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function updateTransferTable() {
            const tbody = document.getElementById('transferTable');
            tbody.innerHTML = transferData.map(item => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.tanggal}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.kode}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.nama}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.qty}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.unit}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.outlet}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                        <button class="text-blue-600 hover:text-blue-900">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function updateOutletTable() {
            const tbody = document.getElementById('outletTable');
            tbody.innerHTML = outletData.map(item => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.kode}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.nama}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                        <button class="text-blue-600 hover:text-blue-900">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function updateDatabaseTable() {
            const tbody = document.getElementById('databaseTable');
            tbody.innerHTML = databaseData.map(item => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.kode}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.nama}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.stock}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${item.unit}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                        <button class="text-blue-600 hover:text-blue-900">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash"></i> Hapus
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function updateOutletSelect() {
            const select = document.getElementById('outletTransfer');
            select.innerHTML = outletData.map(outlet => 
                `<option value="${outlet.kode}">${outlet.nama}</option>`
            ).join('');
        }

        // Helper functions
        function getStatusColor(status) {
            switch(status) {
                case 'diterima': return 'bg-green-100 text-green-800';
                case 'pending': return 'bg-yellow-100 text-yellow-800';
                case 'ditolak': return 'bg-red-100 text-red-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function addToRiwayat(tanggal, kode, nama, keterangan) {
            const tbody = document.getElementById('riwayatTable');
            const newRow = `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${tanggal}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${kode}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${nama}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                        <span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">
                            ${keterangan}
                        </span>
                    </td>
                </tr>
            `;
            tbody.insertAdjacentHTML('afterbegin', newRow);
        }

        // Download functions
        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            doc.setFontSize(20);
            doc.text('Laporan Stok Barang', 20, 20);
            
            doc.setFontSize(12);
            let yPosition = 40;
            
            doc.text('Kode Barang', 20, yPosition);
            doc.text('Nama Barang', 60, yPosition);
            doc.text('Stock', 120, yPosition);
            doc.text('Unit', 150, yPosition);
            
            yPosition += 10;
            
            databaseData.forEach(item => {
                doc.text(item.kode, 20, yPosition);
                doc.text(item.nama, 60, yPosition);
                doc.text(item.stock.toString(), 120, yPosition);
                doc.text(item.unit, 150, yPosition);
                yPosition += 10;
            });
            
            doc.save('laporan-stok-barang.pdf');
            showNotification('Laporan PDF berhasil didownload!', 'success');
        }

        function downloadExcel() {
            const ws = XLSX.utils.json_to_sheet(databaseData.map(item => ({
                'Kode Barang': item.kode,
                'Nama Barang': item.nama,
                'Stock': item.stock,
                'Unit': item.unit
            })));
            
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Laporan Stok');
            
            XLSX.writeFile(wb, 'laporan-stok-barang.xlsx');
            showNotification('Laporan Excel berhasil didownload!', 'success');
        }

        // Notification function
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 z-50 p-4 rounded-lg shadow-lg transition-all duration-300 ${
                type === 'success' ? 'bg-green-500 text-white' : 
                type === 'error' ? 'bg-red-500 text-white' : 
                'bg-blue-500 text-white'
            }`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'times' : 'info'}-circle mr-2"></i>
                    ${message}
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Local storage functions
        function saveLocalData() {
            const allData = {
                penerimaan: penerimaanData,
                transfer: transferData,
                outlet: outletData,
                database: databaseData,
                lastSaved: new Date().toISOString()
            };
            localStorage.setItem('warehouseData', JSON.stringify(allData));
        }

        function loadLocalData() {
            const savedData = localStorage.getItem('warehouseData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    penerimaanData = data.penerimaan || [];
                    transferData = data.transfer || [];
                    outletData = data.outlet || [
                        { kode: 'OUT001', nama: 'Jakarta Pusat' },
                        { kode: 'OUT002', nama: 'Jakarta Selatan' },
                        { kode: 'OUT003', nama: 'Bandung' }
                    ];
                    databaseData = data.database || [
                        { kode: 'BRG001', nama: 'Laptop Dell', stock: 25, unit: 'pcs' },
                        { kode: 'BRG002', nama: 'Mouse Wireless', stock: 150, unit: 'pcs' }
                    ];
                    
                    // Update all tables
                    updatePenerimaanTable();
                    updateTransferTable();
                    updateOutletTable();
                    updateDatabaseTable();
                    updateOutletSelect();
                    
                    showNotification('📁 Data lokal berhasil dimuat', 'info');
                } catch (error) {
                    console.error('Error loading local data:', error);
                }
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setTodayDate();
            updateOutletSelect();
            
            // Show dashboard by default
            showSection('dashboard');
            
            // Set first menu item as active
            document.querySelector('.menu-item').classList.add('bg-blue-50', 'text-blue-600');
            
            // Load data from localStorage if available
            loadLocalData();
            
            // Test connection on load
            setTimeout(() => {
                testConnection();
            }, 1000);
            
            // Auto-save to localStorage every 30 seconds
            setInterval(saveLocalData, 30000);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97c8b1e9e5b79f89',t:'MTc1NzQ0MTk3OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
